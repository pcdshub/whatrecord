
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="SLAC National Accelerator Laboratory">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.7">
    
    
      
        <title>Parsers - whatrecord</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="lightblue" data-md-color-accent="purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#parsers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="whatrecord" class="md-header__button md-logo" aria-label="whatrecord" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.924 7.924 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.924 7.924 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.924 7.924 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.924 7.924 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69L4.41 3M12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            whatrecord
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Parsers
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="lightblue" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      whatrecord
    </a>
  </li>

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="./" class="md-tabs__link md-tabs__link--active">
      Parsers
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../cli/" class="md-tabs__link">
      CLI
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../server_client/" class="md-tabs__link">
      Server / client
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../plugins/" class="md-tabs__link">
      Plugins
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../utilities/" class="md-tabs__link">
      Shared / Utilities
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../iocsh/" class="md-tabs__link">
      IOC Shell-Related
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../lcls/" class="md-tabs__link">
      LCLS
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../tests/" class="md-tabs__link">
      Tests
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="whatrecord" class="md-nav__button md-logo" aria-label="whatrecord" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.924 7.924 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.924 7.924 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.924 7.924 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.924 7.924 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69L4.41 3M12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6z"/></svg>

    </a>
    whatrecord
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        whatrecord
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Parsers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Parsers
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API
  </a>
  
    <nav class="md-nav" aria-label="API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.access_security" class="md-nav__link">
    access_security
  </a>
  
    <nav class="md-nav" aria-label="access_security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.access_security-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.access_security.AccessSecurityConfig" class="md-nav__link">
    AccessSecurityConfig
  </a>
  
    <nav class="md-nav" aria-label="AccessSecurityConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.access_security.AccessSecurityConfig-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.access_security.AccessSecurityGroup" class="md-nav__link">
    AccessSecurityGroup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.access_security.AccessSecurityRule" class="md-nav__link">
    AccessSecurityRule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.access_security.AccessSecurityState" class="md-nav__link">
    AccessSecurityState
  </a>
  
    <nav class="md-nav" aria-label="AccessSecurityState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.access_security.AccessSecurityState-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.access_security.HostAccessGroup" class="md-nav__link">
    HostAccessGroup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.access_security.UserAccessGroup" class="md-nav__link">
    UserAccessGroup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave" class="md-nav__link">
    autosave
  </a>
  
    <nav class="md-nav" aria-label="autosave">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave.AutosaveRestoreFile" class="md-nav__link">
    AutosaveRestoreFile
  </a>
  
    <nav class="md-nav" aria-label="AutosaveRestoreFile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave.AutosaveRestoreFile-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave.AutosaveRestorePassFile" class="md-nav__link">
    AutosaveRestorePassFile
  </a>
  
    <nav class="md-nav" aria-label="AutosaveRestorePassFile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave.AutosaveRestorePassFile-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave.AutosaveSet" class="md-nav__link">
    AutosaveSet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave.AutosaveState" class="md-nav__link">
    AutosaveState
  </a>
  
    <nav class="md-nav" aria-label="AutosaveState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave.AutosaveState-attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave.AutosaveState-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave.RestoreError" class="md-nav__link">
    RestoreError
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.autosave.RestoreValue" class="md-nav__link">
    RestoreValue
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.db" class="md-nav__link">
    db
  </a>
  
    <nav class="md-nav" aria-label="db">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.db-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.db.Database" class="md-nav__link">
    Database
  </a>
  
    <nav class="md-nav" aria-label="Database">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.db.Database-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.db.DatabaseLoadFailure" class="md-nav__link">
    DatabaseLoadFailure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.db.LinterResults" class="md-nav__link">
    LinterResults
  </a>
  
    <nav class="md-nav" aria-label="LinterResults">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.db.LinterResults-attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.db.LinterResults-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.db.UnquotedString" class="md-nav__link">
    UnquotedString
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.db-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.db.split_record_and_field" class="md-nav__link">
    split_record_and_field()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.dbtemplate" class="md-nav__link">
    dbtemplate
  </a>
  
    <nav class="md-nav" aria-label="dbtemplate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.dbtemplate-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.dbtemplate.GlobalDefinitions" class="md-nav__link">
    GlobalDefinitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.dbtemplate.PatternHeader" class="md-nav__link">
    PatternHeader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.dbtemplate.PatternValues" class="md-nav__link">
    PatternValues
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.dbtemplate.Substitution" class="md-nav__link">
    Substitution
  </a>
  
    <nav class="md-nav" aria-label="Substitution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.dbtemplate.Substitution-attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.dbtemplate.Substitution-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.dbtemplate.TemplateSubstitution" class="md-nav__link">
    TemplateSubstitution
  </a>
  
    <nav class="md-nav" aria-label="TemplateSubstitution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.dbtemplate.TemplateSubstitution-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.dbtemplate.VariableDefinitions" class="md-nav__link">
    VariableDefinitions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway" class="md-nav__link">
    gateway
  </a>
  
    <nav class="md-nav" aria-label="gateway">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.AccessSecurity" class="md-nav__link">
    AccessSecurity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.AliasRule" class="md-nav__link">
    AliasRule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.AllowRule" class="md-nav__link">
    AllowRule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.DenyRule" class="md-nav__link">
    DenyRule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.GatewayConfig" class="md-nav__link">
    GatewayConfig
  </a>
  
    <nav class="md-nav" aria-label="GatewayConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.GatewayConfig-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.PVList" class="md-nav__link">
    PVList
  </a>
  
    <nav class="md-nav" aria-label="PVList">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.PVList-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.PVListMatch" class="md-nav__link">
    PVListMatch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.PVListMatches" class="md-nav__link">
    PVListMatches
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.Rule" class="md-nav__link">
    Rule
  </a>
  
    <nav class="md-nav" aria-label="Rule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.Rule-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.gateway.create_arg_parser" class="md-nav__link">
    create_arg_parser()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl" class="md-nav__link">
    snl
  </a>
  
    <nav class="md-nav" aria-label="snl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.AbstractDeclarator" class="md-nav__link">
    AbstractDeclarator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.AbstractDeclaratorModifier" class="md-nav__link">
    AbstractDeclaratorModifier
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Assignment" class="md-nav__link">
    Assignment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.BinaryOperatorExpression" class="md-nav__link">
    BinaryOperatorExpression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Block" class="md-nav__link">
    Block
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.BracketedExpression" class="md-nav__link">
    BracketedExpression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.BreakStatement" class="md-nav__link">
    BreakStatement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.CCode" class="md-nav__link">
    CCode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.CommaSeparatedExpressions" class="md-nav__link">
    CommaSeparatedExpressions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.ContinueStatement" class="md-nav__link">
    ContinueStatement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Declaration" class="md-nav__link">
    Declaration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Declarator" class="md-nav__link">
    Declarator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Definition" class="md-nav__link">
    Definition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.ExitExpression" class="md-nav__link">
    ExitExpression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.ExitTransition" class="md-nav__link">
    ExitTransition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Expression" class="md-nav__link">
    Expression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.ExpressionStatement" class="md-nav__link">
    ExpressionStatement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.ExpressionWithArguments" class="md-nav__link">
    ExpressionWithArguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.ForStatement" class="md-nav__link">
    ForStatement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.ForeignDeclaration" class="md-nav__link">
    ForeignDeclaration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.FuncDef" class="md-nav__link">
    FuncDef
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.IfStatement" class="md-nav__link">
    IfStatement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.InitExpression" class="md-nav__link">
    InitExpression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Literal" class="md-nav__link">
    Literal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.MemberExpression" class="md-nav__link">
    MemberExpression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Monitor" class="md-nav__link">
    Monitor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Option" class="md-nav__link">
    Option
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.ParameterDeclarator" class="md-nav__link">
    ParameterDeclarator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.ParenthesisExpression" class="md-nav__link">
    ParenthesisExpression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.ReturnStatement" class="md-nav__link">
    ReturnStatement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.SequencerProgram" class="md-nav__link">
    SequencerProgram
  </a>
  
    <nav class="md-nav" aria-label="SequencerProgram">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.SequencerProgram-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.SequencerProgramGraph" class="md-nav__link">
    SequencerProgramGraph
  </a>
  
    <nav class="md-nav" aria-label="SequencerProgramGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.SequencerProgramGraph-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.SizeofExpression" class="md-nav__link">
    SizeofExpression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.State" class="md-nav__link">
    State
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.StateSet" class="md-nav__link">
    StateSet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.StateStatement" class="md-nav__link">
    StateStatement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Statement" class="md-nav__link">
    Statement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.StructDef" class="md-nav__link">
    StructDef
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.StructMemberDecl" class="md-nav__link">
    StructMemberDecl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Sync" class="md-nav__link">
    Sync
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.TernaryExpression" class="md-nav__link">
    TernaryExpression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Transition" class="md-nav__link">
    Transition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Type" class="md-nav__link">
    Type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.TypeCastExpression" class="md-nav__link">
    TypeCastExpression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.UnaryPostfixExpression" class="md-nav__link">
    UnaryPostfixExpression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.UnaryPrefixExpression" class="md-nav__link">
    UnaryPrefixExpression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.Variable" class="md-nav__link">
    Variable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.snl.WhileStatement" class="md-nav__link">
    WhileStatement
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.streamdevice" class="md-nav__link">
    streamdevice
  </a>
  
    <nav class="md-nav" aria-label="streamdevice">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.streamdevice-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.streamdevice.Command" class="md-nav__link">
    Command
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.streamdevice.ConfigurationSetting" class="md-nav__link">
    ConfigurationSetting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.streamdevice.HandlerDefinition" class="md-nav__link">
    HandlerDefinition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.streamdevice.ProtocolDefinition" class="md-nav__link">
    ProtocolDefinition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.streamdevice.StreamDeviceState" class="md-nav__link">
    StreamDeviceState
  </a>
  
    <nav class="md-nav" aria-label="StreamDeviceState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.streamdevice.StreamDeviceState-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.streamdevice.StreamProtocol" class="md-nav__link">
    StreamProtocol
  </a>
  
    <nav class="md-nav" aria-label="StreamProtocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.streamdevice.StreamProtocol-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.streamdevice.VariableAssignment" class="md-nav__link">
    VariableAssignment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.transformer" class="md-nav__link">
    transformer
  </a>
  
    <nav class="md-nav" aria-label="transformer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.transformer-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whatrecord.transformer.context_from_token" class="md-nav__link">
    context_from_token()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.transformer.context_from_tree" class="md-nav__link">
    context_from_tree()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.transformer.dictify" class="md-nav__link">
    dictify()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.transformer.ignore" class="md-nav__link">
    ignore()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.transformer.listify" class="md-nav__link">
    listify()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.transformer.listify_strings" class="md-nav__link">
    listify_strings()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.transformer.pass_through" class="md-nav__link">
    pass_through()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.transformer.stringify" class="md-nav__link">
    stringify()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whatrecord.transformer.tuple_args" class="md-nav__link">
    tuple_args()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        CLI
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../server_client/" class="md-nav__link">
        Server / client
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        Plugins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../utilities/" class="md-nav__link">
        Shared / Utilities
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../iocsh/" class="md-nav__link">
        IOC Shell-Related
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../lcls/" class="md-nav__link">
        LCLS
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tests/" class="md-nav__link">
        Tests
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="parsers">Parsers</h1>
<h2 id="usage">Usage</h2>
<p>For each of the parser classes:</p>
<ul>
<li><a href="#whatrecord.access_security.AccessSecurityConfig">AccessSecurityConfig</a></li>
<li><a href="#whatrecord.db.Database">Database</a></li>
<li><a href="#whatrecord.gateway.PVList">GatewayPVList</a></li>
<li><a href="#whatrecord.plugins.epicsarch.LclsEpicsArchFile">LclsEpicsArchFile</a></li>
<li><a href="#whatrecord.snl.SequencerProgram">SequencerProgram</a></li>
<li><a href="#whatrecord.streamdevice.StreamProtocol">StreamProtocol</a></li>
<li><a href="#whatrecord.dbtemplate.TemplateSubstitution">TemplateSubstitution</a></li>
</ul>
<p>Data can be loaded from a file, file object, or string. Filename information
will be automatically added to the load context information when available,
but may be specified separately in the latter case.</p>
<p>Taking <a href="#whatrecord.access_security.AccessSecurityConfig">AccessSecurityConfig</a>
for example:</p>
<pre><code class="language-python">from whatrecord import AccessSecurityConfig

# 1. Load from a file directly
config = AccessSecurityConfig.from_file(&quot;filename.acf&quot;)

# 2. Load from a file object
with open(&quot;filename.acf&quot;, &quot;rt&quot;) as fp:
    config = AccessSecurityConfig.from_file_obj(fp)

# 3. Load from a string:
with open(&quot;filename.acf&quot;, &quot;rt&quot;) as fp:
    contents = fp.read()

config = AccessSecurityConfig.from_string(contents, filename=&quot;filename.acf&quot;)
</code></pre>
<h2 id="api">API</h2>


  <div class="doc doc-object doc-module">



<h3 id="whatrecord.access_security" class="doc doc-heading">
        <code>whatrecord.access_security</code>



</h3>

    <div class="doc doc-contents first">

      <p>V3 Access Security file parsing.</p>
<p>Documentation from the application developer's guide are interspersed here
and in the classes below.</p>
<pre><code>A brief summary of the Functional Requirements is:
    * Each field of each record type is assigned an access security level.
    * Each record instance is assigned to a unique access security group.
    * Each user is assigned to one or more user access groups.
    * Each node is assigned to a host access group.

For each access security group a set of access rules can be defined. Each rule
specifies:
    -  Access security level
    -  READ or READ/WRITE access.
    -  An optional list of User Access Groups or * meaning anyone.
    -  An optional list of Host Access Groups or * meaning anywhere.
    -  Conditions based on values of process variables
</code></pre>



  <div class="doc doc-children">







<h4 id="whatrecord.access_security-classes">Classes</h4>

  <div class="doc doc-object doc-class">



<h5 id="whatrecord.access_security.AccessSecurityConfig" class="doc doc-heading">
        <code>
whatrecord.access_security.AccessSecurityConfig        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>An Access Security Configuration file (ACF) container.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AccessSecurityConfig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;An Access Security Configuration file (ACF) container.&quot;&quot;&quot;</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="nb">hash</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">users</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">UserAccessGroup</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">groups</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AccessSecurityGroup</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">hosts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">HostAccessGroup</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">header</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">comments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">lark</span><span class="o">.</span><span class="n">Token</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">apischema</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">skip</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_group_from_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AccessSecurityGroup</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the appropriate access security group for the given record.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">is_pva</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">access_security_group</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AccessSecurityConfig</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load access security configuration from a string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        contents : str</span>
<span class="sd">            The access security file contents.</span>

<span class="sd">        filename : str, optional</span>
<span class="sd">            The access security filename to use for LoadContext.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">contents_hash</span> <span class="o">=</span> <span class="n">get_bytes_sha256</span><span class="p">(</span><span class="n">contents</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">add_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">:</span> <span class="n">lark</span><span class="o">.</span><span class="n">Token</span><span class="p">):</span>
            <span class="n">comments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">StringWithContext</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;# &quot;</span><span class="p">),</span>
                    <span class="n">context</span><span class="o">=</span><span class="n">context_from_lark_token</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">comment</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
            <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
            <span class="s2">&quot;access_security.lark&quot;</span><span class="p">,</span>
            <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,</span> <span class="p">),</span>
            <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;lalr&quot;</span><span class="p">,</span>
            <span class="n">lexer_callbacks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;COMMENT&quot;</span><span class="p">:</span> <span class="n">add_comment</span><span class="p">},</span>
            <span class="n">transformer</span><span class="o">=</span><span class="n">_AcfTransformer</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">contents_hash</span><span class="p">,</span> <span class="n">comments</span><span class="p">),</span>
            <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AccessSecurityConfig</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load an ACF file from a file object.&quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">fp</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">AccessSecurityConfig</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load an ACF file from a filename.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_file_obj</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="p">))</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">














<h6 id="whatrecord.access_security.AccessSecurityConfig-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.access_security.AccessSecurityConfig.from_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">access_security</span><span class="o">.</span><span class="n">AccessSecurityConfig</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">AccessSecurityConfig</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load an ACF file from a filename.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">AccessSecurityConfig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load an ACF file from a filename.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_file_obj</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.access_security.AccessSecurityConfig.from_file_obj" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">access_security</span><span class="o">.</span><span class="n">AccessSecurityConfig</span><span class="o">.</span><span class="n">from_file_obj</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AccessSecurityConfig</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load an ACF file from a file object.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AccessSecurityConfig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load an ACF file from a file object.&quot;&quot;&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">fp</span><span class="p">)))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.access_security.AccessSecurityConfig.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">access_security</span><span class="o">.</span><span class="n">AccessSecurityConfig</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AccessSecurityConfig</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load access security configuration from a string.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>contents</code></td>
        <td><code>str</code></td>
        <td><p>The access security file contents.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filename</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The access security filename to use for LoadContext.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AccessSecurityConfig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load access security configuration from a string.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    contents : str</span>
<span class="sd">        The access security file contents.</span>

<span class="sd">    filename : str, optional</span>
<span class="sd">        The access security filename to use for LoadContext.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">contents_hash</span> <span class="o">=</span> <span class="n">get_bytes_sha256</span><span class="p">(</span><span class="n">contents</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
    <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">add_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">:</span> <span class="n">lark</span><span class="o">.</span><span class="n">Token</span><span class="p">):</span>
        <span class="n">comments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">StringWithContext</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;# &quot;</span><span class="p">),</span>
                <span class="n">context</span><span class="o">=</span><span class="n">context_from_lark_token</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">comment</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
        <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
        <span class="s2">&quot;access_security.lark&quot;</span><span class="p">,</span>
        <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,</span> <span class="p">),</span>
        <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;lalr&quot;</span><span class="p">,</span>
        <span class="n">lexer_callbacks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;COMMENT&quot;</span><span class="p">:</span> <span class="n">add_comment</span><span class="p">},</span>
        <span class="n">transformer</span><span class="o">=</span><span class="n">_AcfTransformer</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">contents_hash</span><span class="p">,</span> <span class="n">comments</span><span class="p">),</span>
        <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.access_security.AccessSecurityConfig.get_group_from_record" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">access_security</span><span class="o">.</span><span class="n">AccessSecurityConfig</span><span class="o">.</span><span class="n">get_group_from_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AccessSecurityGroup</span><span class="p">]</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Get the appropriate access security group for the given record.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_group_from_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AccessSecurityGroup</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get the appropriate access security group for the given record.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">is_pva</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">access_security_group</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.access_security.AccessSecurityGroup" class="doc doc-heading">
        <code>
whatrecord.access_security.AccessSecurityGroup        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>An access security group.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AccessSecurityGroup</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;An access security group.&quot;&quot;&quot;</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">comments</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">inputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">rules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AccessSecurityRule</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">



















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.access_security.AccessSecurityRule" class="doc doc-heading">
        <code>
whatrecord.access_security.AccessSecurityRule        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Access Security Configuration rule, which defines access permissions.</p>
<p><level> must be 0 or 1. Permission for a level 1 field implies permission
for level 0 fields.</p>
<p>The permissions are NONE, READ, and WRITE. WRITE permission implies READ
permission. The standard EPICS record types have all fields set to level 1
except for VAL, CMD (command), and RES (reset). An optional argument
specifies if writes should be trapped. See the section below on trapping
Channel Access writes for how this is used. If not given the default is
NOTRAPWRITE.</p>
<p>UAG specifies a list of user access groups that can have the access
privilege. If UAG is not defined then all users are allowed.</p>
<p>HAG specifies a list of host access groups that have the access privilege.
If HAG is not defined then all hosts are allowed.</p>
<p>CALC is just like the CALC field of a calculation record except that the
result must evaluate to TRUE or FALSE. The rule only applies if the
calculation result is TRUE, where the actual test for TRUE is
(0.99 &lt; result &lt; 1.01).</p>
<p>Anything else is regarded as FALSE and will cause the rule to be ignored.
Assignment statements are not permitted in CALC expressions here.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@apischema</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">with_fields_set</span>
<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AccessSecurityRule</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Access Security Configuration rule, which defines access permissions.</span>

<span class="sd">    &lt;level&gt; must be 0 or 1. Permission for a level 1 field implies permission</span>
<span class="sd">    for level 0 fields.</span>

<span class="sd">    The permissions are NONE, READ, and WRITE. WRITE permission implies READ</span>
<span class="sd">    permission. The standard EPICS record types have all fields set to level 1</span>
<span class="sd">    except for VAL, CMD (command), and RES (reset). An optional argument</span>
<span class="sd">    specifies if writes should be trapped. See the section below on trapping</span>
<span class="sd">    Channel Access writes for how this is used. If not given the default is</span>
<span class="sd">    NOTRAPWRITE.</span>

<span class="sd">    UAG specifies a list of user access groups that can have the access</span>
<span class="sd">    privilege. If UAG is not defined then all users are allowed.</span>

<span class="sd">    HAG specifies a list of host access groups that have the access privilege.</span>
<span class="sd">    If HAG is not defined then all hosts are allowed.</span>

<span class="sd">    CALC is just like the CALC field of a calculation record except that the</span>
<span class="sd">    result must evaluate to TRUE or FALSE. The rule only applies if the</span>
<span class="sd">    calculation result is TRUE, where the actual test for TRUE is</span>
<span class="sd">    (0.99 &lt; result &lt; 1.01).</span>

<span class="sd">    Anything else is regarded as FALSE and will cause the rule to be ignored.</span>
<span class="sd">    Assignment statements are not permitted in CALC expressions here.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">comments</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">level</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">options</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">log_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">users</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">hosts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">calc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.access_security.AccessSecurityState" class="doc doc-heading">
        <code>
whatrecord.access_security.AccessSecurityState            (<a title="whatrecord.common.ShellStateHandler" href="../utilities/#whatrecord.common.ShellStateHandler">ShellStateHandler</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Access Security IOC shell state handler / container.</p>
<p>Contains hooks for as-related commands and state information.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>config</code></td>
        <td><code>AccessSecurityState</code></td>
        <td><p>The access security configuration.</p></td>
      </tr>
      <tr>
        <td><code>filename</code></td>
        <td><code>pathlib.Path</code></td>
        <td><p>The access security filename.</p></td>
      </tr>
      <tr>
        <td><code>macros</code></td>
        <td><code>Dict[str, str]</code></td>
        <td><p>Macros used when expanding the access security file.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AccessSecurityState</span><span class="p">(</span><span class="n">ShellStateHandler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Access Security IOC shell state handler / container.</span>

<span class="sd">    Contains hooks for as-related commands and state information.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    config : AccessSecurityState</span>
<span class="sd">        The access security configuration.</span>
<span class="sd">    filename : pathlib.Path</span>
<span class="sd">        The access security filename.</span>
<span class="sd">    macros : Dict[str, str]</span>
<span class="sd">        Macros used when expanding the access security file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">metadata_key</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;asg&quot;</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AccessSecurityConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">macros</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">post_ioc_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">post_ioc_init</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;access_security&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_access_security</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;access_security&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;exception_class&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                    <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="p">}</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_asSetSubstitutions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">macros</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">macro_context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span><span class="o">.</span><span class="n">macro_context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macros</span> <span class="o">=</span> <span class="n">macro_context</span><span class="o">.</span><span class="n">definitions_to_dict</span><span class="p">(</span><span class="n">macros</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;macros&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">macros</span><span class="p">,</span>
            <span class="s2">&quot;note&quot;</span><span class="p">:</span> <span class="s2">&quot;See iocInit results for details.&quot;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_asSetFilename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span><span class="o">.</span><span class="n">_fix_path</span><span class="p">(</span>
            <span class="n">filename</span>
        <span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">),</span>
            <span class="s2">&quot;note&quot;</span><span class="p">:</span> <span class="s2">&quot;See iocInit results for details.&quot;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_load_access_security</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load access security settings at iocInit time.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">filename</span><span class="p">,</span> <span class="n">contents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">macros</span><span class="p">:</span>
            <span class="n">macro_context</span> <span class="o">=</span> <span class="n">MacroContext</span><span class="p">(</span><span class="n">use_environment</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">macro_context</span><span class="o">.</span><span class="n">define</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">macros</span><span class="p">)</span>
            <span class="n">contents</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">macro_context</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">contents</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">AccessSecurityConfig</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
            <span class="n">contents</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">filename</span><span class="p">,</span>
            <span class="s2">&quot;macros&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">macros</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">annotate_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Annotate record with access security information.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_group_from_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">asg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">apischema</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">asg</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">











<h6 id="whatrecord.access_security.AccessSecurityState-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.access_security.AccessSecurityState.annotate_record" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">access_security</span><span class="o">.</span><span class="n">AccessSecurityState</span><span class="o">.</span><span class="n">annotate_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Annotate record with access security information.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">annotate_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Annotate record with access security information.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">asg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_group_from_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">asg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">apischema</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">asg</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h7 id="whatrecord.access_security.AccessSecurityState.post_ioc_init" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">access_security</span><span class="o">.</span><span class="n">AccessSecurityState</span><span class="o">.</span><span class="n">post_ioc_init</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Post-iocInit hook.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">post_ioc_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">post_ioc_init</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;access_security&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_access_security</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;access_security&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;exception_class&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.access_security.HostAccessGroup" class="doc doc-heading">
        <code>
whatrecord.access_security.HostAccessGroup        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Host Access Group.</p>
<p>This is a list of host names. It may be empty. The same host name can
appear in multiple HAGs. To match, a host name must match the host name
read by the CA client library running on the client machine; both names are
converted to lower case before comparison however. For vxWorks clients, the
host name is usually taken from the target name of the boot parameters.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">HostAccessGroup</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Host Access Group.</span>

<span class="sd">    This is a list of host names. It may be empty. The same host name can</span>
<span class="sd">    appear in multiple HAGs. To match, a host name must match the host name</span>
<span class="sd">    read by the CA client library running on the client machine; both names are</span>
<span class="sd">    converted to lower case before comparison however. For vxWorks clients, the</span>
<span class="sd">    host name is usually taken from the target name of the boot parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">comments</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">hosts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.access_security.UserAccessGroup" class="doc doc-heading">
        <code>
whatrecord.access_security.UserAccessGroup        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>User Access Group.</p>
<p>This is a list of user names. The list may be empty. A user name may appear
in more than one UAG. To match, a user name must be identical to the user
name read by the CA client library running on the client machine. For
vxWorks clients, the user name is usually taken from the user field of the
boot parameters.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/access_security.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">UserAccessGroup</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    User Access Group.</span>

<span class="sd">    This is a list of user names. The list may be empty. A user name may appear</span>
<span class="sd">    in more than one UAG. To match, a user name must be identical to the user</span>
<span class="sd">    name read by the CA client library running on the client machine. For</span>
<span class="sd">    vxWorks clients, the user name is usually taken from the user field of the</span>
<span class="sd">    boot parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">comments</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">users</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="whatrecord.autosave" class="doc doc-heading">
        <code>whatrecord.autosave</code>



</h3>

    <div class="doc doc-contents first">




  <div class="doc doc-children">






<h4 id="whatrecord.autosave-classes">Classes</h4>

  <div class="doc doc-object doc-class">



<h5 id="whatrecord.autosave.AutosaveRestoreFile" class="doc doc-heading">
        <code>
whatrecord.autosave.AutosaveRestoreFile        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Representation of an autosave restore (.sav) file.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AutosaveRestoreFile</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Representation of an autosave restore (.sav) file.&quot;&quot;&quot;</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RestoreValue</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">disconnected</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RestoreError</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">comments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">macros</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load an autosave file given its string contents.&quot;&quot;&quot;</span>
        <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
            <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
            <span class="s2">&quot;autosave_save.lark&quot;</span><span class="p">,</span>
            <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,</span> <span class="p">),</span>
            <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;earley&quot;</span><span class="p">,</span>
            <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">propagate_positions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">macros</span><span class="p">:</span>
            <span class="n">contents</span> <span class="o">=</span> <span class="n">MacroContext</span><span class="p">(</span><span class="n">macros</span><span class="o">=</span><span class="n">macros</span><span class="p">)</span><span class="o">.</span><span class="n">expand_by_line</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_AutosaveRestoreTransformer</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
            <span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">,</span> <span class="n">macros</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load an autosave file given a file object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
            <span class="n">macros</span><span class="o">=</span><span class="n">macros</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">,</span> <span class="n">macros</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load an autosave restore (.sav) file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : pathlib.Path or str</span>
<span class="sd">            The filename.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        file : AutosaveRestoreFile</span>
<span class="sd">            The resulting parsed file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">macros</span><span class="o">=</span><span class="n">macros</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">












<h6 id="whatrecord.autosave.AutosaveRestoreFile-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveRestoreFile.from_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveRestoreFile</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">,</span> <span class="n">macros</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load an autosave restore (.sav) file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>AnyPath</code></td>
        <td><p>The filename.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>AutosaveRestoreFile</code></td>
      <td><p>The resulting parsed file.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">,</span> <span class="n">macros</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load an autosave restore (.sav) file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : pathlib.Path or str</span>
<span class="sd">        The filename.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    file : AutosaveRestoreFile</span>
<span class="sd">        The resulting parsed file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">macros</span><span class="o">=</span><span class="n">macros</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveRestoreFile.from_file_obj" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveRestoreFile</span><span class="o">.</span><span class="n">from_file_obj</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">,</span> <span class="n">macros</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load an autosave file given a file object.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">,</span> <span class="n">macros</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load an autosave file given a file object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
        <span class="n">filename</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
        <span class="n">macros</span><span class="o">=</span><span class="n">macros</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveRestoreFile.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveRestoreFile</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">macros</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load an autosave file given its string contents.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">macros</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load an autosave file given its string contents.&quot;&quot;&quot;</span>
    <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
        <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
        <span class="s2">&quot;autosave_save.lark&quot;</span><span class="p">,</span>
        <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,</span> <span class="p">),</span>
        <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;earley&quot;</span><span class="p">,</span>
        <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">propagate_positions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">macros</span><span class="p">:</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="n">MacroContext</span><span class="p">(</span><span class="n">macros</span><span class="o">=</span><span class="n">macros</span><span class="p">)</span><span class="o">.</span><span class="n">expand_by_line</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_AutosaveRestoreTransformer</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
        <span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.autosave.AutosaveRestorePassFile" class="doc doc-heading">
        <code>
whatrecord.autosave.AutosaveRestorePassFile        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>AutosaveRestorePassFile(context: 'FullLoadContext', save_filename: 'str', macros: 'Dict[str, str]' = <factory>, pass_number: 'int' = 0, load_timestamp: 'Optional[datetime.datetime]' = None, file_timestamp: 'Optional[datetime.datetime]' = None, data: 'Optional[AutosaveRestoreFile]' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AutosaveRestorePassFile</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">save_filename</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">macros</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">pass_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">load_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">file_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AutosaveRestoreFile</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Update the autosave .sav file from disk.&quot;&quot;&quot;</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">save_path</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_filename</span>
        <span class="n">file_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">file_timestamp</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_timestamp</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_timestamp</span>
            <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">settings</span><span class="o">.</span><span class="n">AUTOSAVE_RELOAD_PERIOD</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">file_timestamp</span> <span class="o">=</span> <span class="n">file_timestamp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">AutosaveRestoreFile</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span>
            <span class="n">fn</span><span class="p">,</span>
            <span class="n">macros</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">macros</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">














<h6 id="whatrecord.autosave.AutosaveRestorePassFile-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveRestorePassFile.update" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveRestorePassFile</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Update the autosave .sav file from disk.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutosaveRestoreFile</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Update the autosave .sav file from disk.&quot;&quot;&quot;</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="n">save_path</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_filename</span>
    <span class="n">file_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">file_timestamp</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_timestamp</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_timestamp</span>
        <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">settings</span><span class="o">.</span><span class="n">AUTOSAVE_RELOAD_PERIOD</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">file_timestamp</span> <span class="o">=</span> <span class="n">file_timestamp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">load_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">AutosaveRestoreFile</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span>
        <span class="n">fn</span><span class="p">,</span>
        <span class="n">macros</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">macros</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.autosave.AutosaveSet" class="doc doc-heading">
        <code>
whatrecord.autosave.AutosaveSet        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>AutosaveSet(context: 'FullLoadContext', request_filename: 'str', save_filename: 'str', period: 'Optional[int]' = None, trigger_channel: 'Optional[str]' = None, macros: 'Dict[str, str]' = <factory>, method: 'str' = 'manual')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AutosaveSet</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">request_filename</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">save_filename</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">trigger_channel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">macros</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;manual&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">





















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.autosave.AutosaveState" class="doc doc-heading">
        <code>
whatrecord.autosave.AutosaveState            (<a title="whatrecord.common.ShellStateHandler" href="../utilities/#whatrecord.common.ShellStateHandler">ShellStateHandler</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>The state of autosave in an IOC.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AutosaveState</span><span class="p">(</span><span class="n">ShellStateHandler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The state of autosave in an IOC.&quot;&quot;&quot;</span>

    <span class="n">metadata_key</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;autosave&quot;</span>

    <span class="n">configured</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">request_paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">save_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span>
    <span class="n">sets</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AutosaveSet</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">restore_files</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AutosaveRestorePassFile</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">incomplete_sets_ok</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: True</span>
    <span class="n">dated_backups</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: True</span>
    <span class="n">date_period_minutes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: 0</span>
    <span class="n">num_seq_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: 3</span>
    <span class="n">seq_period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: 0</span>
    <span class="n">retry_seconds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: 0</span>
    <span class="n">ca_reconnect</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: False</span>
    <span class="n">callback_timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: 0</span>
    <span class="n">task_priority</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: 0</span>
    <span class="n">nfs_host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">use_status_pvs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: False</span>
    <span class="n">status_prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">file_permissions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: 0o664</span>
    <span class="n">debug</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default: 0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">save_name_pv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;The save name PV, derived from the macro context.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span><span class="o">.</span><span class="n">macro_context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SAVENAMEPV&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">save_path_pv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;The save path PV, derived from the macro context.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span><span class="o">.</span><span class="n">macro_context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SAVEPATHPV&quot;</span><span class="p">)</span>

    <span class="c1"># save_restore.c</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_fdbrestore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If save_file refers to a save set that exists in memory, then PV&#39;s in</span>
<span class="sd">        the save set will be restored from values in memory. Otherwise, this</span>
<span class="sd">        functions restores the PV&#39;s in &lt;saveRestorePath&gt;/&lt;save_file&gt; and</span>
<span class="sd">        creates a new backup file &quot;&lt;saveRestorePath&gt;/&lt;save_file&gt;.bu&quot;. The</span>
<span class="sd">        effect probably will not be the same as a boot-time restore, because</span>
<span class="sd">        caput() calls are used instead of static database access dbPutX()</span>
<span class="sd">        calls. Record processing will result from caput()&#39;s to inherently</span>
<span class="sd">        process- passive fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_fdbrestoreX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macrostring</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function restores from the file &lt;saveRestorePath&gt;/&lt;save_file&gt;,</span>
<span class="sd">        which can look just like a save file, but which needn&#39;t end with &lt;END&gt;.</span>
<span class="sd">        No backup file will be written. The effect probably will not be the</span>
<span class="sd">        same as a boot-time restore, because caput() calls are used instead of</span>
<span class="sd">        static database access dbPut*() calls. Record processing will result</span>
<span class="sd">        from caput()&#39;s to inherently process-passive fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_manual_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cause current PV values for the request file to be saved. Any request</span>
<span class="sd">        file named in a create_xxx_set() command can be saved manually.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_set_savefile_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">save_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If a save set has already been created for the request file, this</span>
<span class="sd">        function will change the save file name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">set_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="n">request_file</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Request file not configured&quot;</span><span class="p">)</span>

        <span class="n">set_</span><span class="o">.</span><span class="n">save_filename</span> <span class="o">=</span> <span class="n">save_filename</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_create_periodic_set</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a save set for the request file. The save file will be written</span>
<span class="sd">        every period seconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveSet</span><span class="p">(</span>
            <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
            <span class="n">request_filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">save_filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.sav&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">),</span>
            <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">,</span>
            <span class="n">trigger_channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_create_triggered_set</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">trigger_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a save set for the request file. The save file will be written</span>
<span class="sd">        whenever the PV specified by trigger_channel is posted. Normally this</span>
<span class="sd">        occurs when the PV&#39;s value changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveSet</span><span class="p">(</span>
            <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
            <span class="n">request_filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">save_filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.sav&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">),</span>
            <span class="n">period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">trigger_channel</span><span class="o">=</span><span class="n">trigger_channel</span><span class="p">,</span>
            <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;triggered&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_create_monitor_set</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a save set for the request file. The save file will be written</span>
<span class="sd">        every period seconds, if any PV in the save set was posted</span>
<span class="sd">        (changed value) since the last write.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># An indicator to &quot;start the save task&quot;</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveSet</span><span class="p">(</span>
            <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
            <span class="n">request_filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">save_filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.sav&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">),</span>
            <span class="n">period</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">period</span><span class="p">),</span>
            <span class="n">trigger_channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;monitor&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_create_manual_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a save set for the request file. The save file will be written</span>
<span class="sd">        when the function manual_save() is called with the same request-file</span>
<span class="sd">        name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveSet</span><span class="p">(</span>
            <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
            <span class="n">request_filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">save_filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.sav&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">),</span>
            <span class="n">period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">trigger_channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;manual&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreShow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show the save restore status.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sets</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_set_requestfile_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">subpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="n">full_path</span> <span class="o">=</span> <span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">/</span> <span class="n">subpath</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">full_path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_paths</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">full_path</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_set_savefile_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">subpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called before iocInit(), this function specifies the path to be</span>
<span class="sd">        prepended to save-file and restore-file names. pathsub, if present,</span>
<span class="sd">        will be appended to path, if present, with a separating &#39;/&#39;, whether or</span>
<span class="sd">        not path ends or pathsub begins with &#39;/&#39;. If the result does not end in</span>
<span class="sd">        &#39;/&#39;, one will be appended to it.</span>

<span class="sd">        If save_restore is managing its own NFS mount, this function specifies</span>
<span class="sd">        the mount point, and calling it will result in an NFS mount if all</span>
<span class="sd">        other requirements have already been met. If a valid NFS mount already</span>
<span class="sd">        exists, the file system will be dismounted and then mounted with the</span>
<span class="sd">        new path name. This function can be called at any time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">/</span> <span class="n">subpath</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span><span class="o">.</span><span class="n">_fix_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_set_saveTask_priority</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the priority of the save_restore task.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_priority</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">priority</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_NFSHost</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">mntpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specifies the name and IP address of the NFS host. If both have been</span>
<span class="sd">        specified, and set_savefile_path() has been called to specify the file</span>
<span class="sd">        path, save_restore will manage its own NFS mount. This allows</span>
<span class="sd">        save_restore to recover from a reboot of the NFS host</span>
<span class="sd">        (that is, a stale file handle) and from some kinds of tampering with</span>
<span class="sd">        the save_restore directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfs_host</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;nfs://</span><span class="si">{</span><span class="n">hostname</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">mntpoint</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_remove_data_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;If a save set has been created for request_file, this function will delete it.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_reload_periodic_set</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function allows you to change the PV&#39;s and the period associated</span>
<span class="sd">        with a save set created by create_periodic_set().</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_reload_triggered_set</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">trigger_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function allows you to change the PV&#39;s and the trigger channel</span>
<span class="sd">        associated with a save set created by create_triggered_set().</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_reload_monitor_set</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function allows you to change the PV&#39;s and the period associated</span>
<span class="sd">        with a save set created by create_monitor_set().</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_reload_manual_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macrostring</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function allows you to change the PV&#39;s associated with a save set</span>
<span class="sd">        created by create_manual_set().</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_Debug</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value (int) save_restoreDebug (initially 0). Increase to get</span>
<span class="sd">        more informational messages printed to the console.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_NumSeqFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numSeqFiles</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of (int) save_restoreNumSeqFiles (initially 3). This is</span>
<span class="sd">        the number of sequenced backup files to be maintained.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_seq_files</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numSeqFiles</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_seq_files</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;numSeqFiles must be between 0 and 10 inclusive.&quot;</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_SeqPeriodInSeconds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of (int) save_restoreSeqPeriodInSeconds (initially 60).</span>
<span class="sd">        Sequenced backup files will be written with this period.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq_period</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq_period</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;period must be 10 or greater.&quot;</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_IncompleteSetsOk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of (int) save_restoreIncompleteSetsOk (initially 1). If</span>
<span class="sd">        set to zero, save files will not be restored at boot time unless they</span>
<span class="sd">        are perfect, and they will not be overwritten at save time unless a</span>
<span class="sd">        valid CA connection and value exists for every PV in the list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">incomplete_sets_ok</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_DatedBackupFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of (int) save_restoreDatedBackupFiles (initially 1). If</span>
<span class="sd">        zero, the backup file written at reboot time</span>
<span class="sd">        (a copy of the file from which PV values are restored) will have the</span>
<span class="sd">        suffix &#39;.bu&#39;, and will be overwritten every reboot. If nonzero, each</span>
<span class="sd">        reboot will leave behind its own backup file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dated_backups</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_status_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specifies the prefix to be used to construct the names of PV&#39;s with</span>
<span class="sd">        which save_restore reports its status. If you want autosave to update</span>
<span class="sd">        status PVs as it operates, you must call this function and load the</span>
<span class="sd">        database save_restoreStatus.db, specifying the same prefix in both</span>
<span class="sd">        commands.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_prefix</span> <span class="o">=</span> <span class="n">prefix</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_FilePermissions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permissions</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specify the file permissions used to create new .sav files. This</span>
<span class="sd">        integer value will be supplied, exactly as given, to the system call,</span>
<span class="sd">        open(), and to the call fchmod(). Typically, file permissions are set</span>
<span class="sd">        with an octal number, such as 0640, and</span>
<span class="sd">        save_restoreSet_FilePermissions() will confirm any number given to it</span>
<span class="sd">        by echoing it to the console as an octal number.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_permissions</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">permissions</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_RetrySeconds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specify the time delay between a failed .sav-file write and the retry</span>
<span class="sd">        of that write. The default delay is 60 seconds. If list-PV&#39;s change</span>
<span class="sd">        during the delay, the new values will be written.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retry_seconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_UseStatusPVs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specifies whether save_restore should report its status to a preloaded</span>
<span class="sd">        set of EPICS PV&#39;s (contained in the database save_restoreStatus.db). If</span>
<span class="sd">        the argument is &#39;0&#39;, then status PV&#39;s will not be used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_status_pvs</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_CAReconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specify whether autosave should periodically retry connecting to PVs</span>
<span class="sd">        whose initial connection attempt failed. Currently, the</span>
<span class="sd">        connection-retry interval is hard-wired at 60 seconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ca_reconnect</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_CallbackTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specify the time interval in seconds between forced save-file writes.</span>
<span class="sd">        (-1 means forever). This is intended to get save files written even if</span>
<span class="sd">        the normal trigger mechanism is broken.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callback_timeout</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_asVerify</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">restoreFileName</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compare PV values in the IOC with values written in filename</span>
<span class="sd">        (which should be an autosave restore file, or at least look like one).</span>
<span class="sd">        If restoreFileName is not empty, write a new restore file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_save_restoreSet_periodicDatedBackups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">periodMinutes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of (int) save_restoreDatedBackupFiles (initially 1). If</span>
<span class="sd">        zero, the backup file written at reboot time</span>
<span class="sd">        (a copy of the file from which PV values are restored) will have the</span>
<span class="sd">        suffix &#39;.bu&#39;, and will be overwritten every reboot. If nonzero, each</span>
<span class="sd">        reboot will leave behind its own backup file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dated_backups</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_period_minutes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">periodMinutes</span><span class="p">)</span>

    <span class="c1"># dbrestore.c</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_set_pass0_restoreFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function specifies a save file to be restored during iocInit,</span>
<span class="sd">        before record initialization. An unlimited number of files can be</span>
<span class="sd">        specified using calls to this function. If the file name begins with</span>
<span class="sd">        &quot;/&quot;, autosave will use it as specified; otherwise, autosave will</span>
<span class="sd">        prepend the file path specified to set_savefile_path(). The second</span>
<span class="sd">        argument is optional.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restore_files</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveRestorePassFile</span><span class="p">(</span>
            <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
            <span class="n">save_filename</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
            <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
            <span class="n">pass_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;autosave&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Added pass 0 restore file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">}</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_set_pass1_restoreFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function specifies a save file to be restored during iocInit,</span>
<span class="sd">        after record initialization. An unlimited number of files can be</span>
<span class="sd">        specified using calls to this function. If the file name begins with</span>
<span class="sd">        &quot;/&quot;, autosave will use it as specified; otherwise, autosave will</span>
<span class="sd">        prepend the file path specified to set_savefile_path(). The second</span>
<span class="sd">        argument is optional.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restore_files</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveRestorePassFile</span><span class="p">(</span>
            <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
            <span class="n">save_filename</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
            <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
            <span class="n">pass_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;autosave&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Added pass 1 restore file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">}</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_dbrestoreShow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List all the save sets currently being managed by the save_restore</span>
<span class="sd">        task. If (verbose != 0), lists the PV&#39;s as well.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_makeAutosaveFileFromDbInfo</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">info_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Search through the EPICS database</span>
<span class="sd">        (that is, all EPICS records loaded into an IOC) for &#39;info&#39; nodes named</span>
<span class="sd">        info_name; construct a list of PV names from the associated info_values</span>
<span class="sd">        found, and write the PV names to the file fileBaseName. If fileBaseName</span>
<span class="sd">        does not contain the string &#39;.req&#39;, this string will be appended to it.</span>
<span class="sd">        See makeAutosaveFiles() for more information.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_makeAutosaveFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Search through the EPICS database</span>
<span class="sd">        (that is, all EPICS records loaded into an IOC) for info nodes named</span>
<span class="sd">        &#39;autosaveFields&#39; and &#39;autosaveFields_pass0&#39;; construct lists of PV</span>
<span class="sd">        names from the associated info values, and write the PV names to the</span>
<span class="sd">        files &#39;info_settings.req&#39; and &#39;info_positions.req&#39;, respectively.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_eraseFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Erase (empty) an autosave file.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_appendToFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Append line to a file.</span>

<span class="sd">        For example, to add a line to built_settings.req yourself:</span>

<span class="sd">        appendToFile(&quot;built_settings.req&quot;, &#39;$(P)userStringSeqEnable&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@_handler</span>
    <span class="k">def</span> <span class="nf">handle_autosaveBuild</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">reqFileSuffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        It&#39;s tedious and error prone to have these entries separately</span>
<span class="sd">        maintained, so autosave can do the request-file part for you. To do</span>
<span class="sd">        this, you tell autosave to arrange to be called whenever</span>
<span class="sd">        dbLoadRecords() is called</span>
<span class="sd">        (note that dbLoadTemplate() calls dbLoadRecords()), you tell it how to</span>
<span class="sd">        make a request-file name from a database-file name, and you give it the</span>
<span class="sd">        name of the request file you want it to build. You can do this with the</span>
<span class="sd">        following command:</span>

<span class="sd">            autosaveBuild(&quot;built_settings.req&quot;, &quot;_settings.req&quot;, 1)</span>

<span class="sd">        This tells autosave to do the following:</span>

<span class="sd">            1. Begin building the file built_settings.req. If this is the first</span>
<span class="sd">               call that mentions built_settings.req, erase the file.</span>
<span class="sd">            2. Generate request-file names by stripping &quot;.db&quot;, or &quot;.vdb&quot;, or</span>
<span class="sd">               &quot;.template&quot; from database-file names, and adding the suffix</span>
<span class="sd">               &quot;_settings.req&quot;.</span>
<span class="sd">            3. Enable (disable) automated building if the third argument is 1</span>
<span class="sd">               (0).</span>

<span class="sd">        While automated building is enabled, autosave will generate</span>
<span class="sd">        request-file names and search for those files in its request-file path.</span>
<span class="sd">        If it finds a request file, it will add the appropriate line to</span>
<span class="sd">        built_settings.req.</span>

<span class="sd">        All this does is get the file built_settings.req built. If you want it</span>
<span class="sd">        to be used, you must add the following line to auto_settings.req:</span>

<span class="sd">            file built_settings.req P=$(P)</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">annotate_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">restore_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">restore_files</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">restore_file</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_path</span> <span class="o">/</span> <span class="n">restore_file</span><span class="o">.</span><span class="n">save_filename</span>
                <span class="n">metadata</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Restore file not found: </span><span class="si">{</span><span class="n">fn</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">record_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">record_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">metadata</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;restore&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record_data</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pvname</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">disconnected</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pvname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">pvname</span><span class="p">:</span>
                        <span class="n">field</span> <span class="o">=</span> <span class="n">pvname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">field</span> <span class="o">=</span> <span class="s2">&quot;VAL&quot;</span>
                    <span class="n">metadata</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;disconnected&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">field</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="n">metadata</span> <span class="k">if</span> <span class="n">metadata</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">




<h6 id="whatrecord.autosave.AutosaveState-attributes">Attributes</h6>















  <div class="doc doc-object doc-attribute">



<h7 id="whatrecord.autosave.AutosaveState.save_name_pv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">save_name_pv</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>The save name PV, derived from the macro context.</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h7 id="whatrecord.autosave.AutosaveState.save_path_pv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">save_path_pv</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>The save path PV, derived from the macro context.</p>
    </div>

  </div>









<h6 id="whatrecord.autosave.AutosaveState-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.annotate_record" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">annotate_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Annotate the given record's metadata with state-related information.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">annotate_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">restore_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">restore_files</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">restore_file</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_path</span> <span class="o">/</span> <span class="n">restore_file</span><span class="o">.</span><span class="n">save_filename</span>
            <span class="n">metadata</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Restore file not found: </span><span class="si">{</span><span class="n">fn</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">record_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">record_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">metadata</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;restore&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record_data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pvname</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">disconnected</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pvname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">pvname</span><span class="p">:</span>
                    <span class="n">field</span> <span class="o">=</span> <span class="n">pvname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">field</span> <span class="o">=</span> <span class="s2">&quot;VAL&quot;</span>
                <span class="n">metadata</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;disconnected&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">field</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">metadata</span> <span class="k">if</span> <span class="n">metadata</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_appendToFile" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_appendToFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Append line to a file.</p>
<p>For example, to add a line to built_settings.req yourself:</p>
<p>appendToFile("built_settings.req", '$(P)userStringSeqEnable')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_appendToFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Append line to a file.</span>

<span class="sd">    For example, to add a line to built_settings.req yourself:</span>

<span class="sd">    appendToFile(&quot;built_settings.req&quot;, &#39;$(P)userStringSeqEnable&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_asVerify" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_asVerify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">restoreFileName</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Compare PV values in the IOC with values written in filename</p>
<p>(which should be an autosave restore file, or at least look like one).
If restoreFileName is not empty, write a new restore file.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_asVerify</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">restoreFileName</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compare PV values in the IOC with values written in filename</span>
<span class="sd">    (which should be an autosave restore file, or at least look like one).</span>
<span class="sd">    If restoreFileName is not empty, write a new restore file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_autosaveBuild" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_autosaveBuild</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">reqFileSuffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>It's tedious and error prone to have these entries separately</p>
<p>maintained, so autosave can do the request-file part for you. To do
this, you tell autosave to arrange to be called whenever
dbLoadRecords() is called
(note that dbLoadTemplate() calls dbLoadRecords()), you tell it how to
make a request-file name from a database-file name, and you give it the
name of the request file you want it to build. You can do this with the
following command:</p>
<pre><code>autosaveBuild("built_settings.req", "_settings.req", 1)
</code></pre>
<p>This tells autosave to do the following:</p>
<pre><code>1. Begin building the file built_settings.req. If this is the first
   call that mentions built_settings.req, erase the file.
2. Generate request-file names by stripping ".db", or ".vdb", or
   ".template" from database-file names, and adding the suffix
   "_settings.req".
3. Enable (disable) automated building if the third argument is 1
   (0).
</code></pre>
<p>While automated building is enabled, autosave will generate
request-file names and search for those files in its request-file path.
If it finds a request file, it will add the appropriate line to
built_settings.req.</p>
<p>All this does is get the file built_settings.req built. If you want it
to be used, you must add the following line to auto_settings.req:</p>
<pre><code>file built_settings.req P=$(P)
</code></pre>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_autosaveBuild</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">reqFileSuffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It&#39;s tedious and error prone to have these entries separately</span>
<span class="sd">    maintained, so autosave can do the request-file part for you. To do</span>
<span class="sd">    this, you tell autosave to arrange to be called whenever</span>
<span class="sd">    dbLoadRecords() is called</span>
<span class="sd">    (note that dbLoadTemplate() calls dbLoadRecords()), you tell it how to</span>
<span class="sd">    make a request-file name from a database-file name, and you give it the</span>
<span class="sd">    name of the request file you want it to build. You can do this with the</span>
<span class="sd">    following command:</span>

<span class="sd">        autosaveBuild(&quot;built_settings.req&quot;, &quot;_settings.req&quot;, 1)</span>

<span class="sd">    This tells autosave to do the following:</span>

<span class="sd">        1. Begin building the file built_settings.req. If this is the first</span>
<span class="sd">           call that mentions built_settings.req, erase the file.</span>
<span class="sd">        2. Generate request-file names by stripping &quot;.db&quot;, or &quot;.vdb&quot;, or</span>
<span class="sd">           &quot;.template&quot; from database-file names, and adding the suffix</span>
<span class="sd">           &quot;_settings.req&quot;.</span>
<span class="sd">        3. Enable (disable) automated building if the third argument is 1</span>
<span class="sd">           (0).</span>

<span class="sd">    While automated building is enabled, autosave will generate</span>
<span class="sd">    request-file names and search for those files in its request-file path.</span>
<span class="sd">    If it finds a request file, it will add the appropriate line to</span>
<span class="sd">    built_settings.req.</span>

<span class="sd">    All this does is get the file built_settings.req built. If you want it</span>
<span class="sd">    to be used, you must add the following line to auto_settings.req:</span>

<span class="sd">        file built_settings.req P=$(P)</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_create_manual_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_create_manual_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Create a save set for the request file. The save file will be written</p>
<p>when the function manual_save() is called with the same request-file
name.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_create_manual_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a save set for the request file. The save file will be written</span>
<span class="sd">    when the function manual_save() is called with the same request-file</span>
<span class="sd">    name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveSet</span><span class="p">(</span>
        <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
        <span class="n">request_filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
        <span class="n">save_filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.sav&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">),</span>
        <span class="n">period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">trigger_channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;manual&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_create_monitor_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_create_monitor_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Create a save set for the request file. The save file will be written</p>
<p>every period seconds, if any PV in the save set was posted
(changed value) since the last write.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_create_monitor_set</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a save set for the request file. The save file will be written</span>
<span class="sd">    every period seconds, if any PV in the save set was posted</span>
<span class="sd">    (changed value) since the last write.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># An indicator to &quot;start the save task&quot;</span>
        <span class="k">return</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveSet</span><span class="p">(</span>
        <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
        <span class="n">request_filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
        <span class="n">save_filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.sav&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">),</span>
        <span class="n">period</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">period</span><span class="p">),</span>
        <span class="n">trigger_channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;monitor&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_create_periodic_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_create_periodic_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Create a save set for the request file. The save file will be written</p>
<p>every period seconds.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_create_periodic_set</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a save set for the request file. The save file will be written</span>
<span class="sd">    every period seconds.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveSet</span><span class="p">(</span>
        <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
        <span class="n">request_filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
        <span class="n">save_filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.sav&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">),</span>
        <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">,</span>
        <span class="n">trigger_channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_create_triggered_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_create_triggered_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">trigger_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Create a save set for the request file. The save file will be written</p>
<p>whenever the PV specified by trigger_channel is posted. Normally this
occurs when the PV's value changes.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_create_triggered_set</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">trigger_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a save set for the request file. The save file will be written</span>
<span class="sd">    whenever the PV specified by trigger_channel is posted. Normally this</span>
<span class="sd">    occurs when the PV&#39;s value changes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveSet</span><span class="p">(</span>
        <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
        <span class="n">request_filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
        <span class="n">save_filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.sav&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">),</span>
        <span class="n">period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">trigger_channel</span><span class="o">=</span><span class="n">trigger_channel</span><span class="p">,</span>
        <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;triggered&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_dbrestoreShow" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_dbrestoreShow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>List all the save sets currently being managed by the save_restore</p>
<p>task. If (verbose != 0), lists the PV's as well.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_dbrestoreShow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List all the save sets currently being managed by the save_restore</span>
<span class="sd">    task. If (verbose != 0), lists the PV&#39;s as well.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_eraseFile" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_eraseFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Erase (empty) an autosave file.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_eraseFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Erase (empty) an autosave file.&quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_fdbrestore" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_fdbrestore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>If save_file refers to a save set that exists in memory, then PV's in</p>
<p>the save set will be restored from values in memory. Otherwise, this
functions restores the PV's in <saveRestorePath>/<save_file> and
creates a new backup file "<saveRestorePath>/<save_file>.bu". The
effect probably will not be the same as a boot-time restore, because
caput() calls are used instead of static database access dbPutX()
calls. Record processing will result from caput()'s to inherently
process- passive fields.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_fdbrestore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If save_file refers to a save set that exists in memory, then PV&#39;s in</span>
<span class="sd">    the save set will be restored from values in memory. Otherwise, this</span>
<span class="sd">    functions restores the PV&#39;s in &lt;saveRestorePath&gt;/&lt;save_file&gt; and</span>
<span class="sd">    creates a new backup file &quot;&lt;saveRestorePath&gt;/&lt;save_file&gt;.bu&quot;. The</span>
<span class="sd">    effect probably will not be the same as a boot-time restore, because</span>
<span class="sd">    caput() calls are used instead of static database access dbPutX()</span>
<span class="sd">    calls. Record processing will result from caput()&#39;s to inherently</span>
<span class="sd">    process- passive fields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_fdbrestoreX" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_fdbrestoreX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">macrostring</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>This function restores from the file <saveRestorePath>/<save_file>,</p>
<p>which can look just like a save file, but which needn't end with <END>.
No backup file will be written. The effect probably will not be the
same as a boot-time restore, because caput() calls are used instead of
static database access dbPut*() calls. Record processing will result
from caput()'s to inherently process-passive fields.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_fdbrestoreX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macrostring</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function restores from the file &lt;saveRestorePath&gt;/&lt;save_file&gt;,</span>
<span class="sd">    which can look just like a save file, but which needn&#39;t end with &lt;END&gt;.</span>
<span class="sd">    No backup file will be written. The effect probably will not be the</span>
<span class="sd">    same as a boot-time restore, because caput() calls are used instead of</span>
<span class="sd">    static database access dbPut*() calls. Record processing will result</span>
<span class="sd">    from caput()&#39;s to inherently process-passive fields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_makeAutosaveFileFromDbInfo" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_makeAutosaveFileFromDbInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">info_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Search through the EPICS database</p>
<p>(that is, all EPICS records loaded into an IOC) for 'info' nodes named
info_name; construct a list of PV names from the associated info_values
found, and write the PV names to the file fileBaseName. If fileBaseName
does not contain the string '.req', this string will be appended to it.
See makeAutosaveFiles() for more information.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_makeAutosaveFileFromDbInfo</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">info_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search through the EPICS database</span>
<span class="sd">    (that is, all EPICS records loaded into an IOC) for &#39;info&#39; nodes named</span>
<span class="sd">    info_name; construct a list of PV names from the associated info_values</span>
<span class="sd">    found, and write the PV names to the file fileBaseName. If fileBaseName</span>
<span class="sd">    does not contain the string &#39;.req&#39;, this string will be appended to it.</span>
<span class="sd">    See makeAutosaveFiles() for more information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_makeAutosaveFiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_makeAutosaveFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Search through the EPICS database</p>
<p>(that is, all EPICS records loaded into an IOC) for info nodes named
'autosaveFields' and 'autosaveFields_pass0'; construct lists of PV
names from the associated info values, and write the PV names to the
files 'info_settings.req' and 'info_positions.req', respectively.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_makeAutosaveFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search through the EPICS database</span>
<span class="sd">    (that is, all EPICS records loaded into an IOC) for info nodes named</span>
<span class="sd">    &#39;autosaveFields&#39; and &#39;autosaveFields_pass0&#39;; construct lists of PV</span>
<span class="sd">    names from the associated info values, and write the PV names to the</span>
<span class="sd">    files &#39;info_settings.req&#39; and &#39;info_positions.req&#39;, respectively.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_manual_save" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_manual_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Cause current PV values for the request file to be saved. Any request</p>
<p>file named in a create_xxx_set() command can be saved manually.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_manual_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cause current PV values for the request file to be saved. Any request</span>
<span class="sd">    file named in a create_xxx_set() command can be saved manually.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_reload_manual_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_reload_manual_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">macrostring</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>This function allows you to change the PV's associated with a save set</p>
<p>created by create_manual_set().</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_reload_manual_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macrostring</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function allows you to change the PV&#39;s associated with a save set</span>
<span class="sd">    created by create_manual_set().</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_reload_monitor_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_reload_monitor_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>This function allows you to change the PV's and the period associated</p>
<p>with a save set created by create_monitor_set().</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_reload_monitor_set</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function allows you to change the PV&#39;s and the period associated</span>
<span class="sd">    with a save set created by create_monitor_set().</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_reload_periodic_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_reload_periodic_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>This function allows you to change the PV's and the period associated</p>
<p>with a save set created by create_periodic_set().</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_reload_periodic_set</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function allows you to change the PV&#39;s and the period associated</span>
<span class="sd">    with a save set created by create_periodic_set().</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_reload_triggered_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_reload_triggered_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">trigger_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>This function allows you to change the PV's and the trigger channel</p>
<p>associated with a save set created by create_triggered_set().</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_reload_triggered_set</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">trigger_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function allows you to change the PV&#39;s and the trigger channel</span>
<span class="sd">    associated with a save set created by create_triggered_set().</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_remove_data_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_remove_data_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>If a save set has been created for request_file, this function will delete it.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_remove_data_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;If a save set has been created for request_file, this function will delete it.&quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_CAReconnect" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_CAReconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Specify whether autosave should periodically retry connecting to PVs</p>
<p>whose initial connection attempt failed. Currently, the
connection-retry interval is hard-wired at 60 seconds.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_CAReconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specify whether autosave should periodically retry connecting to PVs</span>
<span class="sd">    whose initial connection attempt failed. Currently, the</span>
<span class="sd">    connection-retry interval is hard-wired at 60 seconds.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ca_reconnect</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_CallbackTimeout" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_CallbackTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Specify the time interval in seconds between forced save-file writes.</p>
<p>(-1 means forever). This is intended to get save files written even if
the normal trigger mechanism is broken.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_CallbackTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specify the time interval in seconds between forced save-file writes.</span>
<span class="sd">    (-1 means forever). This is intended to get save files written even if</span>
<span class="sd">    the normal trigger mechanism is broken.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">callback_timeout</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_DatedBackupFiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_DatedBackupFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Sets the value of (int) save_restoreDatedBackupFiles (initially 1). If</p>
<p>zero, the backup file written at reboot time
(a copy of the file from which PV values are restored) will have the
suffix '.bu', and will be overwritten every reboot. If nonzero, each
reboot will leave behind its own backup file.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_DatedBackupFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the value of (int) save_restoreDatedBackupFiles (initially 1). If</span>
<span class="sd">    zero, the backup file written at reboot time</span>
<span class="sd">    (a copy of the file from which PV values are restored) will have the</span>
<span class="sd">    suffix &#39;.bu&#39;, and will be overwritten every reboot. If nonzero, each</span>
<span class="sd">    reboot will leave behind its own backup file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dated_backups</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_Debug" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_Debug</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Sets the value (int) save_restoreDebug (initially 0). Increase to get</p>
<p>more informational messages printed to the console.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_Debug</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the value (int) save_restoreDebug (initially 0). Increase to get</span>
<span class="sd">    more informational messages printed to the console.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_FilePermissions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_FilePermissions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permissions</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Specify the file permissions used to create new .sav files. This</p>
<p>integer value will be supplied, exactly as given, to the system call,
open(), and to the call fchmod(). Typically, file permissions are set
with an octal number, such as 0640, and
save_restoreSet_FilePermissions() will confirm any number given to it
by echoing it to the console as an octal number.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_FilePermissions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permissions</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specify the file permissions used to create new .sav files. This</span>
<span class="sd">    integer value will be supplied, exactly as given, to the system call,</span>
<span class="sd">    open(), and to the call fchmod(). Typically, file permissions are set</span>
<span class="sd">    with an octal number, such as 0640, and</span>
<span class="sd">    save_restoreSet_FilePermissions() will confirm any number given to it</span>
<span class="sd">    by echoing it to the console as an octal number.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_permissions</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">permissions</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_IncompleteSetsOk" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_IncompleteSetsOk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Sets the value of (int) save_restoreIncompleteSetsOk (initially 1). If</p>
<p>set to zero, save files will not be restored at boot time unless they
are perfect, and they will not be overwritten at save time unless a
valid CA connection and value exists for every PV in the list.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_IncompleteSetsOk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the value of (int) save_restoreIncompleteSetsOk (initially 1). If</span>
<span class="sd">    set to zero, save files will not be restored at boot time unless they</span>
<span class="sd">    are perfect, and they will not be overwritten at save time unless a</span>
<span class="sd">    valid CA connection and value exists for every PV in the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">incomplete_sets_ok</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_NFSHost" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_NFSHost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">mntpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Specifies the name and IP address of the NFS host. If both have been</p>
<p>specified, and set_savefile_path() has been called to specify the file
path, save_restore will manage its own NFS mount. This allows
save_restore to recover from a reboot of the NFS host
(that is, a stale file handle) and from some kinds of tampering with
the save_restore directory.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_NFSHost</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">mntpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specifies the name and IP address of the NFS host. If both have been</span>
<span class="sd">    specified, and set_savefile_path() has been called to specify the file</span>
<span class="sd">    path, save_restore will manage its own NFS mount. This allows</span>
<span class="sd">    save_restore to recover from a reboot of the NFS host</span>
<span class="sd">    (that is, a stale file handle) and from some kinds of tampering with</span>
<span class="sd">    the save_restore directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nfs_host</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;nfs://</span><span class="si">{</span><span class="n">hostname</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">mntpoint</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_NumSeqFiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_NumSeqFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numSeqFiles</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Sets the value of (int) save_restoreNumSeqFiles (initially 3). This is</p>
<p>the number of sequenced backup files to be maintained.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_NumSeqFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numSeqFiles</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the value of (int) save_restoreNumSeqFiles (initially 3). This is</span>
<span class="sd">    the number of sequenced backup files to be maintained.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_seq_files</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numSeqFiles</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_seq_files</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;numSeqFiles must be between 0 and 10 inclusive.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_RetrySeconds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_RetrySeconds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Specify the time delay between a failed .sav-file write and the retry</p>
<p>of that write. The default delay is 60 seconds. If list-PV's change
during the delay, the new values will be written.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_RetrySeconds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specify the time delay between a failed .sav-file write and the retry</span>
<span class="sd">    of that write. The default delay is 60 seconds. If list-PV&#39;s change</span>
<span class="sd">    during the delay, the new values will be written.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">retry_seconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_SeqPeriodInSeconds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_SeqPeriodInSeconds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Sets the value of (int) save_restoreSeqPeriodInSeconds (initially 60).</p>
<p>Sequenced backup files will be written with this period.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_SeqPeriodInSeconds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the value of (int) save_restoreSeqPeriodInSeconds (initially 60).</span>
<span class="sd">    Sequenced backup files will be written with this period.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">seq_period</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq_period</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;period must be 10 or greater.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_UseStatusPVs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_UseStatusPVs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Specifies whether save_restore should report its status to a preloaded</p>
<p>set of EPICS PV's (contained in the database save_restoreStatus.db). If
the argument is '0', then status PV's will not be used.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_UseStatusPVs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specifies whether save_restore should report its status to a preloaded</span>
<span class="sd">    set of EPICS PV&#39;s (contained in the database save_restoreStatus.db). If</span>
<span class="sd">    the argument is &#39;0&#39;, then status PV&#39;s will not be used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_status_pvs</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_periodicDatedBackups" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_periodicDatedBackups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">periodMinutes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Sets the value of (int) save_restoreDatedBackupFiles (initially 1). If</p>
<p>zero, the backup file written at reboot time
(a copy of the file from which PV values are restored) will have the
suffix '.bu', and will be overwritten every reboot. If nonzero, each
reboot will leave behind its own backup file.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_periodicDatedBackups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">periodMinutes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the value of (int) save_restoreDatedBackupFiles (initially 1). If</span>
<span class="sd">    zero, the backup file written at reboot time</span>
<span class="sd">    (a copy of the file from which PV values are restored) will have the</span>
<span class="sd">    suffix &#39;.bu&#39;, and will be overwritten every reboot. If nonzero, each</span>
<span class="sd">    reboot will leave behind its own backup file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dated_backups</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">date_period_minutes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">periodMinutes</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreSet_status_prefix" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreSet_status_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Specifies the prefix to be used to construct the names of PV's with</p>
<p>which save_restore reports its status. If you want autosave to update
status PVs as it operates, you must call this function and load the
database save_restoreStatus.db, specifying the same prefix in both
commands.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreSet_status_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specifies the prefix to be used to construct the names of PV&#39;s with</span>
<span class="sd">    which save_restore reports its status. If you want autosave to update</span>
<span class="sd">    status PVs as it operates, you must call this function and load the</span>
<span class="sd">    database save_restoreStatus.db, specifying the same prefix in both</span>
<span class="sd">    commands.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">status_prefix</span> <span class="o">=</span> <span class="n">prefix</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_save_restoreShow" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_save_restoreShow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Show the save restore status.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_save_restoreShow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Show the save restore status.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sets</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_set_pass0_restoreFile" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_set_pass0_restoreFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>This function specifies a save file to be restored during iocInit,</p>
<p>before record initialization. An unlimited number of files can be
specified using calls to this function. If the file name begins with
"/", autosave will use it as specified; otherwise, autosave will
prepend the file path specified to set_savefile_path(). The second
argument is optional.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_set_pass0_restoreFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function specifies a save file to be restored during iocInit,</span>
<span class="sd">    before record initialization. An unlimited number of files can be</span>
<span class="sd">    specified using calls to this function. If the file name begins with</span>
<span class="sd">    &quot;/&quot;, autosave will use it as specified; otherwise, autosave will</span>
<span class="sd">    prepend the file path specified to set_savefile_path(). The second</span>
<span class="sd">    argument is optional.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">restore_files</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveRestorePassFile</span><span class="p">(</span>
        <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
        <span class="n">save_filename</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
        <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
        <span class="n">pass_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;autosave&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Added pass 0 restore file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_set_pass1_restoreFile" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_set_pass1_restoreFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>This function specifies a save file to be restored during iocInit,</p>
<p>after record initialization. An unlimited number of files can be
specified using calls to this function. If the file name begins with
"/", autosave will use it as specified; otherwise, autosave will
prepend the file path specified to set_savefile_path(). The second
argument is optional.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_set_pass1_restoreFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function specifies a save file to be restored during iocInit,</span>
<span class="sd">    after record initialization. An unlimited number of files can be</span>
<span class="sd">    specified using calls to this function. If the file name begins with</span>
<span class="sd">    &quot;/&quot;, autosave will use it as specified; otherwise, autosave will</span>
<span class="sd">    prepend the file path specified to set_savefile_path(). The second</span>
<span class="sd">    argument is optional.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">restore_files</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutosaveRestorePassFile</span><span class="p">(</span>
        <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_load_context</span><span class="p">(),</span>
        <span class="n">save_filename</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
        <span class="n">macros</span><span class="o">=</span><span class="n">macros_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">),</span>
        <span class="n">pass_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;autosave&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Added pass 1 restore file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_set_saveTask_priority" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_set_saveTask_priority</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Set the priority of the save_restore task.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_set_saveTask_priority</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the priority of the save_restore task.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">task_priority</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">priority</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_set_savefile_name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_set_savefile_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">save_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>If a save set has already been created for the request file, this</p>
<p>function will change the save file name.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_set_savefile_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">save_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If a save set has already been created for the request file, this</span>
<span class="sd">    function will change the save file name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">set_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="n">request_file</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Request file not configured&quot;</span><span class="p">)</span>

    <span class="n">set_</span><span class="o">.</span><span class="n">save_filename</span> <span class="o">=</span> <span class="n">save_filename</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.autosave.AutosaveState.handle_set_savefile_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">autosave</span><span class="o">.</span><span class="n">AutosaveState</span><span class="o">.</span><span class="n">handle_set_savefile_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">subpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Called before iocInit(), this function specifies the path to be</p>
<p>prepended to save-file and restore-file names. pathsub, if present,
will be appended to path, if present, with a separating '/', whether or
not path ends or pathsub begins with '/'. If the result does not end in
'/', one will be appended to it.</p>
<p>If save_restore is managing its own NFS mount, this function specifies
the mount point, and calling it will result in an NFS mount if all
other requirements have already been met. If a valid NFS mount already
exists, the file system will be dismounted and then mounted with the
new path name. This function can be called at any time.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@_handler</span>
<span class="k">def</span> <span class="nf">handle_set_savefile_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">subpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Called before iocInit(), this function specifies the path to be</span>
<span class="sd">    prepended to save-file and restore-file names. pathsub, if present,</span>
<span class="sd">    will be appended to path, if present, with a separating &#39;/&#39;, whether or</span>
<span class="sd">    not path ends or pathsub begins with &#39;/&#39;. If the result does not end in</span>
<span class="sd">    &#39;/&#39;, one will be appended to it.</span>

<span class="sd">    If save_restore is managing its own NFS mount, this function specifies</span>
<span class="sd">    the mount point, and calling it will result in an NFS mount if all</span>
<span class="sd">    other requirements have already been met. If a valid NFS mount already</span>
<span class="sd">    exists, the file system will be dismounted and then mounted with the</span>
<span class="sd">    new path name. This function can be called at any time.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">/</span> <span class="n">subpath</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span><span class="o">.</span><span class="n">_fix_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.autosave.RestoreError" class="doc doc-heading">
        <code>
whatrecord.autosave.RestoreError        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>RestoreError(context: 'FullLoadContext', number: 'int', description: 'str')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">RestoreError</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">number</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.autosave.RestoreValue" class="doc doc-heading">
        <code>
whatrecord.autosave.RestoreValue        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>RestoreValue(context: 'FullLoadContext', pvname: 'str', record: 'str', field: 'str', value: 'Union[str, List[str]]')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/autosave.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">RestoreValue</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">pvname</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">record</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">field</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">



















  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="whatrecord.db" class="doc doc-heading">
        <code>whatrecord.db</code>



</h3>

    <div class="doc doc-contents first">




  <div class="doc doc-children">






<h4 id="whatrecord.db-classes">Classes</h4>

  <div class="doc doc-object doc-class">



<h5 id="whatrecord.db.Database" class="doc doc-heading">
        <code>
whatrecord.db.Database        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Representation of an EPICS database, database definition, or both.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>standalone_aliases</code></td>
        <td></td>
        <td><p>Standalone aliases are those defined outside of the record body; this
may only be useful for faithfully reconstructing the Database according
to its original source code.  Keyed on alias to actual record name.</p></td>
      </tr>
      <tr>
        <td><code>aliases</code></td>
        <td></td>
        <td><p>Alias name to record name.</p></td>
      </tr>
      <tr>
        <td><code>paths</code></td>
        <td></td>
        <td><p>The path command specifies the current search path for use when loading
database and database definition files. The addpath appends directory
names to the current path. The path is used to locate the initial
database file and included files. An empty dir at the beginning,
middle, or end of a non-empty path string means the current directory.</p></td>
      </tr>
      <tr>
        <td><code>addpaths</code></td>
        <td></td>
        <td><p>See 'paths' above.</p></td>
      </tr>
      <tr>
        <td><code>breaktables</code></td>
        <td></td>
        <td><p>Breakpoint table (look-up table) of raw-to-engineering values.</p></td>
      </tr>
      <tr>
        <td><code>comments</code></td>
        <td></td>
        <td><p>Comments encountered while parsing the database.</p></td>
      </tr>
      <tr>
        <td><code>devices</code></td>
        <td></td>
        <td><p>Device support declarations (dset).</p></td>
      </tr>
      <tr>
        <td><code>drivers</code></td>
        <td></td>
        <td><p>Driver declarations (drvet).</p></td>
      </tr>
      <tr>
        <td><code>functions</code></td>
        <td></td>
        <td><p>Exported C function names.</p></td>
      </tr>
      <tr>
        <td><code>includes</code></td>
        <td></td>
        <td><p>Inline inclusion. Not supported just yet.</p></td>
      </tr>
      <tr>
        <td><code>links</code></td>
        <td></td>
        <td><p>Links.</p></td>
      </tr>
      <tr>
        <td><code>menus</code></td>
        <td></td>
        <td><p>Named value enumerations (enums).</p></td>
      </tr>
      <tr>
        <td><code>records</code></td>
        <td></td>
        <td><p>Record name to RecordInstance.</p></td>
      </tr>
      <tr>
        <td><code>record_types</code></td>
        <td></td>
        <td><p>Record type name to RecordType.</p></td>
      </tr>
      <tr>
        <td><code>registrars</code></td>
        <td></td>
        <td><p>Exported registrar function name.</p></td>
      </tr>
      <tr>
        <td><code>variables</code></td>
        <td></td>
        <td><p>IOC shell variables.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Database</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Representation of an EPICS database, database definition, or both.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    standalone_aliases :</span>
<span class="sd">        Standalone aliases are those defined outside of the record body; this</span>
<span class="sd">        may only be useful for faithfully reconstructing the Database according</span>
<span class="sd">        to its original source code.  Keyed on alias to actual record name.</span>

<span class="sd">    aliases :</span>
<span class="sd">        Alias name to record name.</span>

<span class="sd">    paths :</span>
<span class="sd">        The path command specifies the current search path for use when loading</span>
<span class="sd">        database and database definition files. The addpath appends directory</span>
<span class="sd">        names to the current path. The path is used to locate the initial</span>
<span class="sd">        database file and included files. An empty dir at the beginning,</span>
<span class="sd">        middle, or end of a non-empty path string means the current directory.</span>

<span class="sd">    addpaths :</span>
<span class="sd">        See &#39;paths&#39; above.</span>

<span class="sd">    breaktables :</span>
<span class="sd">        Breakpoint table (look-up table) of raw-to-engineering values.</span>

<span class="sd">    comments :</span>
<span class="sd">        Comments encountered while parsing the database.</span>

<span class="sd">    devices :</span>
<span class="sd">        Device support declarations (dset).</span>

<span class="sd">    drivers :</span>
<span class="sd">        Driver declarations (drvet).</span>

<span class="sd">    functions :</span>
<span class="sd">        Exported C function names.</span>

<span class="sd">    includes :</span>
<span class="sd">        Inline inclusion. Not supported just yet.</span>

<span class="sd">    links :</span>
<span class="sd">        Links.</span>

<span class="sd">    menus :</span>
<span class="sd">        Named value enumerations (enums).</span>

<span class="sd">    records :</span>
<span class="sd">        Record name to RecordInstance.</span>

<span class="sd">    record_types :</span>
<span class="sd">        Record type name to RecordType.</span>

<span class="sd">    registrars :</span>
<span class="sd">        Exported registrar function name.</span>

<span class="sd">    variables :</span>
<span class="sd">        IOC shell variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">standalone_aliases</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">aliases</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">addpaths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">breaktables</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">comments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">devices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DatabaseDevice</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">drivers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">includes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">links</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">menus</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DatabaseMenu</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">records</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RecordInstance</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">pva_groups</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RecordInstance</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">record_types</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RecordType</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">registrars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">variables</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Database</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
        <span class="n">include_aliases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">lint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LinterResults</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load a database [definition] from a string.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dbd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dbd</span><span class="p">,</span> <span class="n">Database</span><span class="p">):</span>
            <span class="n">dbd</span> <span class="o">=</span> <span class="n">Database</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">dbd</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">)</span>

        <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
            <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;db.v</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">.lark&quot;</span><span class="p">,</span>
            <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,</span> <span class="p">),</span>
            <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;lalr&quot;</span><span class="p">,</span>
            <span class="n">lexer_callbacks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;COMMENT&quot;</span><span class="p">:</span> <span class="n">comments</span><span class="o">.</span><span class="n">append</span><span class="p">},</span>
            <span class="n">transformer</span><span class="o">=</span><span class="n">_DatabaseTransformer</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dbd</span><span class="o">=</span><span class="n">dbd</span><span class="p">,</span> <span class="n">lint</span><span class="o">=</span><span class="n">lint</span><span class="p">),</span>
            <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="c1"># Per-user `gettempdir` caching of the LALR grammar analysis way of</span>
            <span class="c1"># passing ``True`` here:</span>
            <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">macro_context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">contents</span> <span class="o">=</span> <span class="n">macro_context</span><span class="o">.</span><span class="n">expand_by_line</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">db</span><span class="p">,</span> <span class="n">linter_results</span> <span class="o">=</span> <span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
        <span class="n">db</span><span class="o">.</span><span class="n">comments</span> <span class="o">=</span> <span class="n">comments</span>

        <span class="k">if</span> <span class="n">include_aliases</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">record_name</span><span class="p">,</span> <span class="n">record</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">record</span><span class="o">.</span><span class="n">aliases</span><span class="p">:</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">records</span><span class="p">[</span><span class="n">alias</span><span class="p">]</span> <span class="o">=</span> <span class="n">record</span>

        <span class="k">return</span> <span class="n">db</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span>
        <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Database</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
        <span class="n">lint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LinterResults</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load a database [definition] from a file object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">dbd</span><span class="o">=</span><span class="n">dbd</span><span class="p">,</span>
            <span class="n">macro_context</span><span class="o">=</span><span class="n">macro_context</span><span class="p">,</span>
            <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
            <span class="n">lint</span><span class="o">=</span><span class="n">lint</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
        <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Database</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
        <span class="n">lint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LinterResults</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load a database [definition] from a filename.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
                <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span>
                <span class="n">dbd</span><span class="o">=</span><span class="n">dbd</span><span class="p">,</span>
                <span class="n">macro_context</span><span class="o">=</span><span class="n">macro_context</span><span class="p">,</span>
                <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
                <span class="n">lint</span><span class="o">=</span><span class="n">lint</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">field_names_by_type</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">field_types</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FrozenSet</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate dictionary of record type to frozenset of field names.</span>

<span class="sd">        This can be used in scenarios where database definition files are</span>
<span class="sd">        unavailable and link information is requested.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field_types : list of str</span>
<span class="sd">            Field types to look for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">by_rtype</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">rtype</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">record_types</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">by_rtype</span><span class="p">[</span><span class="n">rtype</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span>
                <span class="n">field</span><span class="o">.</span><span class="n">name</span>
                <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">field_types</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">by_rtype</span>

    <span class="k">def</span> <span class="nf">add_or_update_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update (or add) records given a dictionary of records.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">is_pva</span><span class="p">:</span>
            <span class="n">existing_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pva_groups</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">existing_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">existing_record</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">records</span><span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">record</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">existing_record</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Database</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Append the other database, best-effort updating existing entries.</span>

<span class="sd">        This is not likely to do everything correctly (TODO).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_or_update_record</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">pva_groups</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_or_update_record</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_update_list</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="n">this</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">other</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this</span><span class="p">])</span>

        <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addpaths</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">addpaths</span><span class="p">)</span>
        <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comments</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">comments</span><span class="p">)</span>
        <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">devices</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">devices</span><span class="p">)</span>
        <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drivers</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">drivers</span><span class="p">)</span>
        <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">functions</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">functions</span><span class="p">)</span>
        <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">includes</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">includes</span><span class="p">)</span>
        <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">paths</span><span class="p">)</span>
        <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">registrars</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">registrars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">aliases</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">breaktables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">breaktables</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">links</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menus</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">menus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">record_types</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">record_types</span> <span class="ow">or</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standalone_aliases</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">standalone_aliases</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_multiple</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">items</span><span class="p">:</span> <span class="n">_DatabaseSource</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a Database instance from multiple sources, including:</span>

<span class="sd">        * Other Database instances</span>
<span class="sd">        * LinterResults</span>
<span class="sd">        * LoadedIoc</span>
<span class="sd">        * ShellState</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.shell</span> <span class="kn">import</span> <span class="n">LoadedIoc</span><span class="p">,</span> <span class="n">ShellState</span>

        <span class="n">db</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Database</span><span class="p">):</span>
                <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">LinterResults</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">db</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="n">LoadedIoc</span><span class="p">,</span> <span class="n">ShellState</span><span class="p">)):</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">shell_state</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">LoadedIoc</span><span class="p">)</span> <span class="k">else</span> <span class="n">item</span>
                <span class="n">new_records</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pva_database</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">new_records</span><span class="p">:</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">add_or_update_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
                <span class="n">db</span><span class="o">.</span><span class="n">aliases</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">aliases</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="n">_DatabaseSource</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">db</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
























<h6 id="whatrecord.db.Database-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.db.Database.add_or_update_record" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Database</span><span class="o">.</span><span class="n">add_or_update_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Update (or add) records given a dictionary of records.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_or_update_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update (or add) records given a dictionary of records.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">is_pva</span><span class="p">:</span>
        <span class="n">existing_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pva_groups</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">existing_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">existing_record</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">records</span><span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">record</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">existing_record</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.db.Database.append" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Database</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Database</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Append the other database, best-effort updating existing entries.</p>
<p>This is not likely to do everything correctly (TODO).</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Append the other database, best-effort updating existing entries.</span>

<span class="sd">    This is not likely to do everything correctly (TODO).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_or_update_record</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">pva_groups</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_or_update_record</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_list</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">this</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">other</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this</span><span class="p">])</span>

    <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addpaths</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">addpaths</span><span class="p">)</span>
    <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comments</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">comments</span><span class="p">)</span>
    <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">devices</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">devices</span><span class="p">)</span>
    <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drivers</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">drivers</span><span class="p">)</span>
    <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">functions</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">functions</span><span class="p">)</span>
    <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">includes</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">includes</span><span class="p">)</span>
    <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">paths</span><span class="p">)</span>
    <span class="n">_update_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">registrars</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">registrars</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">aliases</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">breaktables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">breaktables</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">links</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">menus</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">menus</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">record_types</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">record_types</span> <span class="ow">or</span> <span class="p">{})</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">standalone_aliases</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">standalone_aliases</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.db.Database.field_names_by_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Database</span><span class="o">.</span><span class="n">field_names_by_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_types</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FrozenSet</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Generate dictionary of record type to frozenset of field names.</p>
<p>This can be used in scenarios where database definition files are
unavailable and link information is requested.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>field_types</code></td>
        <td><code>List[str]</code></td>
        <td><p>Field types to look for.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">field_names_by_type</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">field_types</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FrozenSet</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate dictionary of record type to frozenset of field names.</span>

<span class="sd">    This can be used in scenarios where database definition files are</span>
<span class="sd">    unavailable and link information is requested.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    field_types : list of str</span>
<span class="sd">        Field types to look for.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">by_rtype</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">rtype</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">record_types</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="n">by_rtype</span><span class="p">[</span><span class="n">rtype</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span>
            <span class="n">field</span><span class="o">.</span><span class="n">name</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">field_types</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">by_rtype</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.db.Database.from_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Database</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Database</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">lint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LinterResults</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a database [definition] from a filename.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Database</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">lint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LinterResults</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load a database [definition] from a filename.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span>
            <span class="n">dbd</span><span class="o">=</span><span class="n">dbd</span><span class="p">,</span>
            <span class="n">macro_context</span><span class="o">=</span><span class="n">macro_context</span><span class="p">,</span>
            <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
            <span class="n">lint</span><span class="o">=</span><span class="n">lint</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.db.Database.from_file_obj" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Database</span><span class="o">.</span><span class="n">from_file_obj</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Database</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">lint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LinterResults</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a database [definition] from a file object.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span>
    <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Database</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">lint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LinterResults</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load a database [definition] from a file object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">filename</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">dbd</span><span class="o">=</span><span class="n">dbd</span><span class="p">,</span>
        <span class="n">macro_context</span><span class="o">=</span><span class="n">macro_context</span><span class="p">,</span>
        <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
        <span class="n">lint</span><span class="o">=</span><span class="n">lint</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.db.Database.from_multiple" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Database</span><span class="o">.</span><span class="n">from_multiple</span><span class="p">(</span><span class="o">*</span><span class="n">items</span><span class="p">:</span> <span class="n">_DatabaseSource</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Create a Database instance from multiple sources, including:</p>
<ul>
<li>Other Database instances</li>
<li>LinterResults</li>
<li>LoadedIoc</li>
<li>ShellState</li>
</ul>

        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_multiple</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">items</span><span class="p">:</span> <span class="n">_DatabaseSource</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Database instance from multiple sources, including:</span>

<span class="sd">    * Other Database instances</span>
<span class="sd">    * LinterResults</span>
<span class="sd">    * LoadedIoc</span>
<span class="sd">    * ShellState</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.shell</span> <span class="kn">import</span> <span class="n">LoadedIoc</span><span class="p">,</span> <span class="n">ShellState</span>

    <span class="n">db</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Database</span><span class="p">):</span>
            <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">LinterResults</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">db</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="n">LoadedIoc</span><span class="p">,</span> <span class="n">ShellState</span><span class="p">)):</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">shell_state</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">LoadedIoc</span><span class="p">)</span> <span class="k">else</span> <span class="n">item</span>
            <span class="n">new_records</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pva_database</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">new_records</span><span class="p">:</span>
                <span class="n">db</span><span class="o">.</span><span class="n">add_or_update_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">aliases</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">aliases</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="n">_DatabaseSource</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">db</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.db.Database.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Database</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Database</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">include_aliases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">lint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LinterResults</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a database [definition] from a string.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Database</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">include_aliases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">lint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LinterResults</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load a database [definition] from a string.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dbd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dbd</span><span class="p">,</span> <span class="n">Database</span><span class="p">):</span>
        <span class="n">dbd</span> <span class="o">=</span> <span class="n">Database</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">dbd</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">)</span>

    <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
        <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;db.v</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">.lark&quot;</span><span class="p">,</span>
        <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,</span> <span class="p">),</span>
        <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;lalr&quot;</span><span class="p">,</span>
        <span class="n">lexer_callbacks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;COMMENT&quot;</span><span class="p">:</span> <span class="n">comments</span><span class="o">.</span><span class="n">append</span><span class="p">},</span>
        <span class="n">transformer</span><span class="o">=</span><span class="n">_DatabaseTransformer</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dbd</span><span class="o">=</span><span class="n">dbd</span><span class="p">,</span> <span class="n">lint</span><span class="o">=</span><span class="n">lint</span><span class="p">),</span>
        <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="c1"># Per-user `gettempdir` caching of the LALR grammar analysis way of</span>
        <span class="c1"># passing ``True`` here:</span>
        <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">macro_context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="n">macro_context</span><span class="o">.</span><span class="n">expand_by_line</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="n">db</span><span class="p">,</span> <span class="n">linter_results</span> <span class="o">=</span> <span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
    <span class="n">db</span><span class="o">.</span><span class="n">comments</span> <span class="o">=</span> <span class="n">comments</span>

    <span class="k">if</span> <span class="n">include_aliases</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">record_name</span><span class="p">,</span> <span class="n">record</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">record</span><span class="o">.</span><span class="n">aliases</span><span class="p">:</span>
                <span class="n">db</span><span class="o">.</span><span class="n">records</span><span class="p">[</span><span class="n">alias</span><span class="p">]</span> <span class="o">=</span> <span class="n">record</span>

    <span class="k">return</span> <span class="n">db</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.db.DatabaseLoadFailure" class="doc doc-heading">
        <code>
whatrecord.db.DatabaseLoadFailure            (<span title="Exception">Exception</span>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Database load failure.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">DatabaseLoadFailure</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Database load failure.&quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div>
        </details>


    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.db.LinterResults" class="doc doc-heading">
        <code>
whatrecord.db.LinterResults        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Container for dbdlint results, with easier-to-access attributes.</p>
<p>Reimplementation of <code>pyPDB.dbdlint.Results</code>.</p>
<p>Each error or warning has dictionary keys::</p>
<pre><code>{name, message, file, line, raw_message, format_args}
</code></pre>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>errors</code></td>
        <td><code>list</code></td>
        <td><p>List of errors found</p></td>
      </tr>
      <tr>
        <td><code>warnings</code></td>
        <td><code>list</code></td>
        <td><p>List of warnings found</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">LinterResults</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Container for dbdlint results, with easier-to-access attributes.</span>

<span class="sd">    Reimplementation of ``pyPDB.dbdlint.Results``.</span>

<span class="sd">    Each error or warning has dictionary keys::</span>

<span class="sd">        {name, message, file, line, raw_message, format_args}</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    errors : list</span>
<span class="sd">        List of errors found</span>
<span class="sd">    warnings : list</span>
<span class="sd">        List of warnings found</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">macros</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">LinterError</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">LinterWarning</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">db</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Database</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">apischema</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">skip</span>
    <span class="p">)</span>
    <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Database</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">apischema</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">skip</span>
    <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_database_string</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">db</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Database</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">db_filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LinterResults</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lint a db (database) file using its database definition file (dbd).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        db : str</span>
<span class="sd">            The database source.</span>
<span class="sd">        dbd : Database</span>
<span class="sd">            The pre-loaded database definition.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        results : LinterResults</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lint</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dbd</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dbd</span><span class="p">,</span> <span class="n">Database</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dbd should be a Database instance&quot;</span><span class="p">)</span>

        <span class="c1"># The following fills `lint`, for better or worse</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">Database</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
            <span class="n">db</span><span class="p">,</span> <span class="n">dbd</span><span class="o">=</span><span class="n">dbd</span><span class="p">,</span> <span class="n">macro_context</span><span class="o">=</span><span class="n">macro_context</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
            <span class="n">lint</span><span class="o">=</span><span class="n">lint</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">db_filename</span>
        <span class="p">)</span>
        <span class="n">lint</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">database</span>
        <span class="n">lint</span><span class="o">.</span><span class="n">dbd</span> <span class="o">=</span> <span class="n">dbd</span>
        <span class="n">lint</span><span class="o">.</span><span class="n">macros</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">macro_context</span> <span class="ow">or</span> <span class="p">{})</span>
        <span class="k">return</span> <span class="n">lint</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_database_file</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">db_filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
        <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Database</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LinterResults</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lint a db (database) file using its database definition file (dbd).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        db : str</span>
<span class="sd">            The database filename.</span>
<span class="sd">        dbd : Database</span>
<span class="sd">            The database definition.</span>
<span class="sd">        version : int, optional</span>
<span class="sd">            Use the old V3 style or new V3 style database grammar by specifying</span>
<span class="sd">            3 or 4, respectively.  Defaults to 3.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        results : LinterResults</span>
<span class="sd">        db : Database</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">db_filename</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_database_string</span><span class="p">(</span>
            <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">,</span>
            <span class="n">dbd</span><span class="o">=</span><span class="n">dbd</span><span class="p">,</span>
            <span class="n">db_filename</span><span class="o">=</span><span class="n">db_filename</span><span class="p">,</span>
            <span class="n">macro_context</span><span class="o">=</span><span class="n">macro_context</span><span class="p">,</span>
            <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">record_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RecordType</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Defined record types.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbd</span><span class="o">.</span><span class="n">record_types</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">record_types</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">records</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RecordInstance</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Defined V3 records.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">records</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pva_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RecordInstance</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Defined PVAccess groups.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">pva_groups</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;records=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">records</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;pva_groups=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pva_groups</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;errors=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;warnings=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">warnings</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&gt;&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">




<h6 id="whatrecord.db.LinterResults-attributes">Attributes</h6>





  <div class="doc doc-object doc-attribute">



<h7 id="whatrecord.db.LinterResults.pva_groups" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">LinterResults</span><span class="o">.</span><span class="n">pva_groups</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RecordInstance</span><span class="p">]]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Defined PVAccess groups.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="whatrecord.db.LinterResults.record_types" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">LinterResults</span><span class="o">.</span><span class="n">record_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RecordType</span><span class="p">]]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Defined record types.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="whatrecord.db.LinterResults.records" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">LinterResults</span><span class="o">.</span><span class="n">records</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RecordInstance</span><span class="p">]]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Defined V3 records.</p>
    </div>

  </div>





<h6 id="whatrecord.db.LinterResults-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.db.LinterResults.from_database_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">LinterResults</span><span class="o">.</span><span class="n">from_database_file</span><span class="p">(</span><span class="n">db_filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Database</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LinterResults</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Lint a db (database) file using its database definition file (dbd).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>db</code></td>
        <td><code>str</code></td>
        <td><p>The database filename.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dbd</code></td>
        <td><code>Optional[Database]</code></td>
        <td><p>The database definition.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>version</code></td>
        <td><code>int</code></td>
        <td><p>Use the old V3 style or new V3 style database grammar by specifying
3 or 4, respectively.  Defaults to 3.</p></td>
        <td><code>3</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_database_file</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">db_filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Database</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LinterResults</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Lint a db (database) file using its database definition file (dbd).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    db : str</span>
<span class="sd">        The database filename.</span>
<span class="sd">    dbd : Database</span>
<span class="sd">        The database definition.</span>
<span class="sd">    version : int, optional</span>
<span class="sd">        Use the old V3 style or new V3 style database grammar by specifying</span>
<span class="sd">        3 or 4, respectively.  Defaults to 3.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : LinterResults</span>
<span class="sd">    db : Database</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">db_filename</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_database_string</span><span class="p">(</span>
        <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">,</span>
        <span class="n">dbd</span><span class="o">=</span><span class="n">dbd</span><span class="p">,</span>
        <span class="n">db_filename</span><span class="o">=</span><span class="n">db_filename</span><span class="p">,</span>
        <span class="n">macro_context</span><span class="o">=</span><span class="n">macro_context</span><span class="p">,</span>
        <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.db.LinterResults.from_database_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">LinterResults</span><span class="o">.</span><span class="n">from_database_string</span><span class="p">(</span><span class="n">db</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Database</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">db_filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LinterResults</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Lint a db (database) file using its database definition file (dbd).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>db</code></td>
        <td><code>str</code></td>
        <td><p>The database source.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dbd</code></td>
        <td><code>Optional[Database]</code></td>
        <td><p>The pre-loaded database definition.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_database_string</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">db</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dbd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Database</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">macro_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MacroContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">db_filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LinterResults</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Lint a db (database) file using its database definition file (dbd).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    db : str</span>
<span class="sd">        The database source.</span>
<span class="sd">    dbd : Database</span>
<span class="sd">        The pre-loaded database definition.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : LinterResults</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lint</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">dbd</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dbd</span><span class="p">,</span> <span class="n">Database</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dbd should be a Database instance&quot;</span><span class="p">)</span>

    <span class="c1"># The following fills `lint`, for better or worse</span>
    <span class="n">database</span> <span class="o">=</span> <span class="n">Database</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
        <span class="n">db</span><span class="p">,</span> <span class="n">dbd</span><span class="o">=</span><span class="n">dbd</span><span class="p">,</span> <span class="n">macro_context</span><span class="o">=</span><span class="n">macro_context</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
        <span class="n">lint</span><span class="o">=</span><span class="n">lint</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">db_filename</span>
    <span class="p">)</span>
    <span class="n">lint</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">database</span>
    <span class="n">lint</span><span class="o">.</span><span class="n">dbd</span> <span class="o">=</span> <span class="n">dbd</span>
    <span class="n">lint</span><span class="o">.</span><span class="n">macros</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">macro_context</span> <span class="ow">or</span> <span class="p">{})</span>
    <span class="k">return</span> <span class="n">lint</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.db.UnquotedString" class="doc doc-heading">
        <code>
whatrecord.db.UnquotedString            (<span title="str">str</span>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>An unquoted string token found when loading a database file.</p>
<p>May be a linter warning.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">UnquotedString</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An unquoted string token found when loading a database file.</span>
<span class="sd">    May be a linter warning.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div>
        </details>


    </div>

  </div>


<h4 id="whatrecord.db-functions">Functions</h4>

  <div class="doc doc-object doc-function">



<h5 id="whatrecord.db.split_record_and_field" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">split_record_and_field</span><span class="p">(</span><span class="n">pvname</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Split REC.FLD into REC and FLD.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">split_record_and_field</span><span class="p">(</span><span class="n">pvname</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Split REC.FLD into REC and FLD.&quot;&quot;&quot;</span>
    <span class="n">record</span><span class="p">,</span> <span class="o">*</span><span class="n">field</span> <span class="o">=</span> <span class="n">pvname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">record</span><span class="p">,</span> <span class="n">field</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">field</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="whatrecord.dbtemplate" class="doc doc-heading">
        <code>whatrecord.dbtemplate</code>



</h3>

    <div class="doc doc-contents first">

      <p>dbLoadTemplate and msi -S substitution grammar helpers.</p>



  <div class="doc doc-children">







<h4 id="whatrecord.dbtemplate-classes">Classes</h4>

  <div class="doc doc-object doc-class">



<h5 id="whatrecord.dbtemplate.GlobalDefinitions" class="doc doc-heading">
        <code>
whatrecord.dbtemplate.GlobalDefinitions            (<a title="whatrecord.dbtemplate.VariableDefinitions" href="#whatrecord.dbtemplate.VariableDefinitions">VariableDefinitions</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Global variable definitions.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">GlobalDefinitions</span><span class="p">(</span><span class="n">VariableDefinitions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Global variable definitions.&quot;&quot;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.dbtemplate.PatternHeader" class="doc doc-heading">
        <code>
whatrecord.dbtemplate.PatternHeader        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Pattern header.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PatternHeader</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Pattern header.&quot;&quot;&quot;</span>

    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.dbtemplate.PatternValues" class="doc doc-heading">
        <code>
whatrecord.dbtemplate.PatternValues        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Pattern values.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PatternValues</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Pattern values.&quot;&quot;&quot;</span>

    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.dbtemplate.Substitution" class="doc doc-heading">
        <code>
whatrecord.dbtemplate.Substitution        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Single database template file from a full template.</p>
<p>Represents approximately one line of a .substitutions file. For example,
in this substitution file,</p>
<pre><code>    file template.txt {
        pattern {a, b, c}
        {A, B, C}
    }
</code></pre>
<p>The resulting Substitution would be</p>
<p><code>Substitution(macros={"a": "A", "b": "B", "c": "C"}, filename="template.txt")</code>.</p>
<p>Global macro values will be aggregated into this dictionary.</p>
<p>Inside of the template file - <code>template.txt</code> above:
* "include" is a supported command for the template file.
* "substitute" is optionally supported (set <code>allow_substitute</code>)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Substitution</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Single database template file from a full template.</span>

<span class="sd">    Represents approximately one line of a .substitutions file. For example,</span>
<span class="sd">    in this substitution file,</span>

<span class="sd">    ```</span>
<span class="sd">        file template.txt {</span>
<span class="sd">            pattern {a, b, c}</span>
<span class="sd">            {A, B, C}</span>
<span class="sd">        }</span>
<span class="sd">    ```</span>

<span class="sd">    The resulting Substitution would be</span>

<span class="sd">    ``Substitution(macros={&quot;a&quot;: &quot;A&quot;, &quot;b&quot;: &quot;B&quot;, &quot;c&quot;: &quot;C&quot;}, filename=&quot;template.txt&quot;)``.</span>

<span class="sd">    Global macro values will be aggregated into this dictionary.</span>

<span class="sd">    Inside of the template file - ``template.txt`` above:</span>
<span class="sd">    * &quot;include&quot; is a supported command for the template file.</span>
<span class="sd">    * &quot;substitute&quot; is optionally supported (set ``allow_substitute``)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">macros</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">use_environment</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">allow_substitute</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">_items</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">apischema</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">skip</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">expand_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expand the given file, looking in ``search_paths`` for template files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str, optional</span>
<span class="sd">            Expand this file or fall back to the instance-defined filename.</span>

<span class="sd">        search_paths : list of str or pathlib.Path, optional</span>
<span class="sd">            List of paths to search for template files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This substitution does not have a file defined&quot;</span><span class="p">)</span>

        <span class="n">filename</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">search_paths</span> <span class="o">=</span> <span class="n">search_paths</span> <span class="ow">or</span> <span class="p">[</span><span class="n">filename</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">search_paths</span><span class="o">=</span><span class="n">search_paths</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">macro_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MacroContext</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The macro context to be used when expanding the template.&quot;&quot;&quot;</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">MacroContext</span><span class="p">(</span><span class="n">use_environment</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_environment</span><span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">define</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">macros</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ctx</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">handle_include</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">search_paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Expand include files from the given search path.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">search_paths</span><span class="p">:</span>
            <span class="n">option</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">/</span> <span class="n">filename</span>
            <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="n">friendly_paths</span> <span class="o">=</span> <span class="s2">&quot; or &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">search_paths</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> not found in </span><span class="si">{</span><span class="n">friendly_paths</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expand the provided substitution template, using the macro environment.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        source : str</span>
<span class="sd">            The source substitution template.  May contain &quot;include&quot; or</span>
<span class="sd">            &quot;substitute&quot; lines.</span>

<span class="sd">        search_paths : list of str or pathlib.Path, optional</span>
<span class="sd">            List of paths to search for template files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">macro_context</span>
        <span class="n">search_paths</span> <span class="o">=</span> <span class="n">search_paths</span> <span class="ow">or</span> <span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">source_stack</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())</span>
        <span class="k">while</span> <span class="n">source_stack</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">source_stack</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;line </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">command</span><span class="p">,</span> <span class="o">*</span><span class="n">command_args</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;include&quot;</span><span class="p">:</span>  <span class="c1"># case sensitive</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">command_args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Include command takes one argument; got: </span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;where line=</span><span class="si">{</span><span class="n">line</span><span class="si">!r}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="n">include_file</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Including file from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">include_file</span><span class="p">)</span>
                <span class="n">include_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_include</span><span class="p">(</span><span class="n">include_file</span><span class="p">,</span> <span class="n">search_paths</span><span class="p">)</span>
                <span class="n">source_stack</span><span class="o">.</span><span class="n">extendleft</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">include_source</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()))</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;stack </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">source_stack</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;substitute&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_substitute</span><span class="p">:</span>
                <span class="c1"># Note that dbLoadTemplate does not support substitute, but msi</span>
                <span class="c1"># does.</span>
                <span class="n">macro_string</span> <span class="o">=</span> <span class="n">command_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="c1"># Strip only single beginning and end quotes</span>
                <span class="n">macro_string</span> <span class="o">=</span> <span class="n">_strip_double_quote</span><span class="p">(</span><span class="n">macro_string</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Substituting additional macros </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">)</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">define_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">




<h6 id="whatrecord.dbtemplate.Substitution-attributes">Attributes</h6>




  <div class="doc doc-object doc-attribute">



<h7 id="whatrecord.dbtemplate.Substitution.macro_context" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">dbtemplate</span><span class="o">.</span><span class="n">Substitution</span><span class="o">.</span><span class="n">macro_context</span><span class="p">:</span> <span class="n">MacroContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>The macro context to be used when expanding the template.</p>
    </div>

  </div>






<h6 id="whatrecord.dbtemplate.Substitution-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.dbtemplate.Substitution.expand" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">dbtemplate</span><span class="o">.</span><span class="n">Substitution</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Expand the provided substitution template, using the macro environment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>The source substitution template.  May contain "include" or
"substitute" lines.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>search_paths</code></td>
        <td><code>Optional[List[AnyPath]]</code></td>
        <td><p>List of paths to search for template files.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expand the provided substitution template, using the macro environment.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    source : str</span>
<span class="sd">        The source substitution template.  May contain &quot;include&quot; or</span>
<span class="sd">        &quot;substitute&quot; lines.</span>

<span class="sd">    search_paths : list of str or pathlib.Path, optional</span>
<span class="sd">        List of paths to search for template files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">macro_context</span>
    <span class="n">search_paths</span> <span class="o">=</span> <span class="n">search_paths</span> <span class="ow">or</span> <span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">source_stack</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())</span>
    <span class="k">while</span> <span class="n">source_stack</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">source_stack</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;line </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">command</span><span class="p">,</span> <span class="o">*</span><span class="n">command_args</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;include&quot;</span><span class="p">:</span>  <span class="c1"># case sensitive</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">command_args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Include command takes one argument; got: </span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;where line=</span><span class="si">{</span><span class="n">line</span><span class="si">!r}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">include_file</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Including file from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">include_file</span><span class="p">)</span>
            <span class="n">include_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_include</span><span class="p">(</span><span class="n">include_file</span><span class="p">,</span> <span class="n">search_paths</span><span class="p">)</span>
            <span class="n">source_stack</span><span class="o">.</span><span class="n">extendleft</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">include_source</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;stack </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">source_stack</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;substitute&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_substitute</span><span class="p">:</span>
            <span class="c1"># Note that dbLoadTemplate does not support substitute, but msi</span>
            <span class="c1"># does.</span>
            <span class="n">macro_string</span> <span class="o">=</span> <span class="n">command_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="c1"># Strip only single beginning and end quotes</span>
            <span class="n">macro_string</span> <span class="o">=</span> <span class="n">_strip_double_quote</span><span class="p">(</span><span class="n">macro_string</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Substituting additional macros </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">macro_string</span><span class="p">)</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">define_from_string</span><span class="p">(</span><span class="n">macro_string</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.dbtemplate.Substitution.expand_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">dbtemplate</span><span class="o">.</span><span class="n">Substitution</span><span class="o">.</span><span class="n">expand_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Expand the given file, looking in <code>search_paths</code> for template files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Expand this file or fall back to the instance-defined filename.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>search_paths</code></td>
        <td><code>Optional[List[AnyPath]]</code></td>
        <td><p>List of paths to search for template files.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">expand_file</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expand the given file, looking in ``search_paths`` for template files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str, optional</span>
<span class="sd">        Expand this file or fall back to the instance-defined filename.</span>

<span class="sd">    search_paths : list of str or pathlib.Path, optional</span>
<span class="sd">        List of paths to search for template files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This substitution does not have a file defined&quot;</span><span class="p">)</span>

    <span class="n">filename</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">search_paths</span> <span class="o">=</span> <span class="n">search_paths</span> <span class="ow">or</span> <span class="p">[</span><span class="n">filename</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">search_paths</span><span class="o">=</span><span class="n">search_paths</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.dbtemplate.Substitution.handle_include" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">dbtemplate</span><span class="o">.</span><span class="n">Substitution</span><span class="o">.</span><span class="n">handle_include</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">search_paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Expand include files from the given search path.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">handle_include</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">search_paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Expand include files from the given search path.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">search_paths</span><span class="p">:</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">/</span> <span class="n">filename</span>
        <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">friendly_paths</span> <span class="o">=</span> <span class="s2">&quot; or &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">search_paths</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> not found in </span><span class="si">{</span><span class="n">friendly_paths</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.dbtemplate.TemplateSubstitution" class="doc doc-heading">
        <code>
whatrecord.dbtemplate.TemplateSubstitution        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Database substitutions, containing zero or more template files.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TemplateSubstitution</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Database substitutions, containing zero or more template files.&quot;&quot;&quot;</span>

    <span class="n">substitutions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Substitution</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">expand_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expands all substitutions for the given string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        template : str</span>
<span class="sd">            The template text.</span>

<span class="sd">        delimiter : str, optional</span>
<span class="sd">            Delimiter to join individual substitutions.</span>

<span class="sd">        search_paths : list of str or pathlib.Path, optional</span>
<span class="sd">            List of paths to search for template files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">sub</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">search_paths</span><span class="o">=</span><span class="n">search_paths</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitutions</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">expand_files</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expands and combines all contained substitution files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        delimiter : str, optional</span>
<span class="sd">            Delimiter to join individual substitutions.</span>

<span class="sd">        search_paths : list of str or pathlib.Path, optional</span>
<span class="sd">            List of paths to search for template files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">sub</span><span class="o">.</span><span class="n">expand_file</span><span class="p">(</span><span class="n">search_paths</span><span class="o">=</span><span class="n">search_paths</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitutions</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">contents</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">msi_format</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">all_global_scope</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TemplateSubstitution</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load a template substitutions file given its string contents.&quot;&quot;&quot;</span>
        <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">grammar_filename</span> <span class="o">=</span> <span class="s2">&quot;msi-sub.lark&quot;</span> <span class="k">if</span> <span class="n">msi_format</span> <span class="k">else</span> <span class="s2">&quot;dbtemplate.lark&quot;</span>

        <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
            <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
            <span class="n">grammar_filename</span><span class="p">,</span>
            <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,),</span>
            <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;earley&quot;</span><span class="p">,</span>
            <span class="c1"># TODO: This is unsupported in lark:</span>
            <span class="c1"># lexer_callbacks={&quot;COMMENT&quot;: comments.append},</span>
            <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">propagate_positions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">msi_format</span><span class="p">:</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">_TemplateMsiTransformer</span><span class="p">(</span>
                <span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">all_global_scope</span><span class="o">=</span><span class="n">all_global_scope</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">_TemplateTransformer</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="n">subs</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contents</span><span class="p">))</span>
        <span class="n">subs</span><span class="o">.</span><span class="n">comments</span> <span class="o">=</span> <span class="n">comments</span>
        <span class="k">return</span> <span class="n">subs</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TemplateSubstitution</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load a template file given a file object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TemplateSubstitution</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load a template file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : pathlib.Path or str</span>
<span class="sd">            The filename.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        template : TemplateSubstitution</span>
<span class="sd">            The template file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">fn</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">








<h6 id="whatrecord.dbtemplate.TemplateSubstitution-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.dbtemplate.TemplateSubstitution.expand_files" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">dbtemplate</span><span class="o">.</span><span class="n">TemplateSubstitution</span><span class="o">.</span><span class="n">expand_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Expands and combines all contained substitution files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>delimiter</code></td>
        <td><code>str</code></td>
        <td><p>Delimiter to join individual substitutions.</p></td>
        <td><code>&#39;\n&#39;</code></td>
      </tr>
      <tr>
        <td><code>search_paths</code></td>
        <td><code>Optional[List[AnyPath]]</code></td>
        <td><p>List of paths to search for template files.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">expand_files</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expands and combines all contained substitution files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    delimiter : str, optional</span>
<span class="sd">        Delimiter to join individual substitutions.</span>

<span class="sd">    search_paths : list of str or pathlib.Path, optional</span>
<span class="sd">        List of paths to search for template files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">sub</span><span class="o">.</span><span class="n">expand_file</span><span class="p">(</span><span class="n">search_paths</span><span class="o">=</span><span class="n">search_paths</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitutions</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.dbtemplate.TemplateSubstitution.expand_template" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">dbtemplate</span><span class="o">.</span><span class="n">TemplateSubstitution</span><span class="o">.</span><span class="n">expand_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Expands all substitutions for the given string.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>template</code></td>
        <td><code>str</code></td>
        <td><p>The template text.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>delimiter</code></td>
        <td><code>str</code></td>
        <td><p>Delimiter to join individual substitutions.</p></td>
        <td><code>&#39;\n&#39;</code></td>
      </tr>
      <tr>
        <td><code>search_paths</code></td>
        <td><code>Optional[List[AnyPath]]</code></td>
        <td><p>List of paths to search for template files.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">expand_template</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">search_paths</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expands all substitutions for the given string.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    template : str</span>
<span class="sd">        The template text.</span>

<span class="sd">    delimiter : str, optional</span>
<span class="sd">        Delimiter to join individual substitutions.</span>

<span class="sd">    search_paths : list of str or pathlib.Path, optional</span>
<span class="sd">        List of paths to search for template files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">sub</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">search_paths</span><span class="o">=</span><span class="n">search_paths</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitutions</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.dbtemplate.TemplateSubstitution.from_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">dbtemplate</span><span class="o">.</span><span class="n">TemplateSubstitution</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TemplateSubstitution</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a template file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>pathlib.Path or str</code></td>
        <td><p>The filename.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>TemplateSubstitution</code></td>
      <td><p>The template file.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TemplateSubstitution</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a template file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : pathlib.Path or str</span>
<span class="sd">        The filename.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    template : TemplateSubstitution</span>
<span class="sd">        The template file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">fn</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.dbtemplate.TemplateSubstitution.from_file_obj" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">dbtemplate</span><span class="o">.</span><span class="n">TemplateSubstitution</span><span class="o">.</span><span class="n">from_file_obj</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TemplateSubstitution</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a template file given a file object.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TemplateSubstitution</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load a template file given a file object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
        <span class="n">filename</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.dbtemplate.TemplateSubstitution.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">dbtemplate</span><span class="o">.</span><span class="n">TemplateSubstitution</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">msi_format</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">all_global_scope</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TemplateSubstitution</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a template substitutions file given its string contents.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">contents</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">msi_format</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">all_global_scope</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TemplateSubstitution</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load a template substitutions file given its string contents.&quot;&quot;&quot;</span>
    <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">grammar_filename</span> <span class="o">=</span> <span class="s2">&quot;msi-sub.lark&quot;</span> <span class="k">if</span> <span class="n">msi_format</span> <span class="k">else</span> <span class="s2">&quot;dbtemplate.lark&quot;</span>

    <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
        <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
        <span class="n">grammar_filename</span><span class="p">,</span>
        <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,),</span>
        <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;earley&quot;</span><span class="p">,</span>
        <span class="c1"># TODO: This is unsupported in lark:</span>
        <span class="c1"># lexer_callbacks={&quot;COMMENT&quot;: comments.append},</span>
        <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">propagate_positions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">msi_format</span><span class="p">:</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="n">_TemplateMsiTransformer</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">all_global_scope</span><span class="o">=</span><span class="n">all_global_scope</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="n">_TemplateTransformer</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="n">subs</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contents</span><span class="p">))</span>
    <span class="n">subs</span><span class="o">.</span><span class="n">comments</span> <span class="o">=</span> <span class="n">comments</span>
    <span class="k">return</span> <span class="n">subs</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.dbtemplate.VariableDefinitions" class="doc doc-heading">
        <code>
whatrecord.dbtemplate.VariableDefinitions        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Variable definitions.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/dbtemplate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">VariableDefinitions</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Variable definitions.&quot;&quot;&quot;</span>

    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">definitions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="whatrecord.gateway" class="doc doc-heading">
        <code>whatrecord.gateway</code>



</h3>

    <div class="doc doc-contents first">




  <div class="doc doc-children">







<h4 id="whatrecord.gateway-classes">Classes</h4>

  <div class="doc doc-object doc-class">



<h5 id="whatrecord.gateway.AccessSecurity" class="doc doc-heading">
        <code>
whatrecord.gateway.AccessSecurity        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>A PVList rule access security settings.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AccessSecurity</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A PVList rule access security settings.&quot;&quot;&quot;</span>
    <span class="n">group</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">level</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.gateway.AliasRule" class="doc doc-heading">
        <code>
whatrecord.gateway.AliasRule            (<a title="whatrecord.gateway.Rule" href="#whatrecord.gateway.Rule">Rule</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Rule to alias the pattern to a PV (or PVs).</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AliasRule</span><span class="p">(</span><span class="n">Rule</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rule to alias the pattern to a PV (or PVs).&quot;&quot;&quot;</span>
    <span class="n">pvname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">access</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AccessSecurity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.gateway.AllowRule" class="doc doc-heading">
        <code>
whatrecord.gateway.AllowRule            (<a title="whatrecord.gateway.Rule" href="#whatrecord.gateway.Rule">Rule</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Rule to allow access to a PV pattern.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AllowRule</span><span class="p">(</span><span class="n">Rule</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rule to allow access to a PV pattern.&quot;&quot;&quot;</span>
    <span class="n">access</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AccessSecurity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.gateway.DenyRule" class="doc doc-heading">
        <code>
whatrecord.gateway.DenyRule            (<a title="whatrecord.gateway.Rule" href="#whatrecord.gateway.Rule">Rule</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Rule to deny access to a PV pattern.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">DenyRule</span><span class="p">(</span><span class="n">Rule</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rule to deny access to a PV pattern.&quot;&quot;&quot;</span>
    <span class="n">hosts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.gateway.GatewayConfig" class="doc doc-heading">
        <code>
whatrecord.gateway.GatewayConfig        </code>



</h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GatewayConfig</span><span class="p">:</span>
    <span class="n">pvlists</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PVList</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">glob_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*.pvlist&quot;</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">glob_str</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pvlists</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">filename</span><span class="p">:</span> <span class="n">PVList</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update a gateway configuration file.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pvlists</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">PVList</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update any changed files.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pvlist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pvlists</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">get_file_sha256</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pvlist</span><span class="o">.</span><span class="n">hash</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating changed gateway file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">remove_any</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PVListMatches</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get matches from any PVList given a PV name.&quot;&quot;&quot;</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">PVListMatch</span><span class="p">(</span>
                <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="p">),</span>
                <span class="n">rule</span><span class="o">=</span><span class="n">rule</span><span class="p">,</span>
                <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">fn</span><span class="p">,</span> <span class="n">pvlist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pvlists</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">rule</span><span class="p">,</span> <span class="n">groups</span> <span class="ow">in</span> <span class="n">pvlist</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">pattern</span> <span class="o">!=</span> <span class="s2">&quot;.*&quot;</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">remove_any</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">PVListMatches</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">matches</span><span class="o">=</span><span class="n">matches</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">







<h6 id="whatrecord.gateway.GatewayConfig-methods">Methods</h6>


  <div class="doc doc-object doc-method">



<h7 id="whatrecord.gateway.GatewayConfig.get_matches" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">GatewayConfig</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">remove_any</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PVListMatches</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Get matches from any PVList given a PV name.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">remove_any</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PVListMatches</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get matches from any PVList given a PV name.&quot;&quot;&quot;</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">PVListMatch</span><span class="p">(</span>
            <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="p">),</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule</span><span class="p">,</span>
            <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">fn</span><span class="p">,</span> <span class="n">pvlist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pvlists</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">rule</span><span class="p">,</span> <span class="n">groups</span> <span class="ow">in</span> <span class="n">pvlist</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">pattern</span> <span class="o">!=</span> <span class="s2">&quot;.*&quot;</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">remove_any</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">PVListMatches</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">matches</span><span class="o">=</span><span class="n">matches</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.gateway.GatewayConfig.update_changed" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">GatewayConfig</span><span class="o">.</span><span class="n">update_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Update any changed files.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update any changed files.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pvlist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pvlists</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">get_file_sha256</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pvlist</span><span class="o">.</span><span class="n">hash</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating changed gateway file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.gateway.PVList" class="doc doc-heading">
        <code>
whatrecord.gateway.PVList        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>A PVList container.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PVList</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A PVList container.&quot;&quot;&quot;</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">evaluation_order</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">rules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Rule</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="nb">hash</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">header</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">comments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">lark</span><span class="o">.</span><span class="n">Token</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">apischema</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">skip</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Rule</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Yield matching rule types.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">rule</span>

    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Rule</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Yield matching rules.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">rule</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">contents_hash</span> <span class="o">=</span> <span class="n">get_bytes_sha256</span><span class="p">(</span><span class="n">contents</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">add_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">:</span> <span class="n">lark</span><span class="o">.</span><span class="n">Token</span><span class="p">):</span>
            <span class="n">comments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">StringWithContext</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;# &quot;</span><span class="p">),</span>
                    <span class="n">context</span><span class="o">=</span><span class="n">context_from_lark_token</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">comment</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
            <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gateway.lark&quot;</span><span class="p">,</span>
            <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,</span> <span class="p">),</span>
            <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;lalr&quot;</span><span class="p">,</span>
            <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">lexer_callbacks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;COMMENT&quot;</span><span class="p">:</span> <span class="n">add_comment</span><span class="p">},</span>
            <span class="n">transformer</span><span class="o">=</span><span class="n">_PVListTransformer</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">contents_hash</span><span class="p">,</span> <span class="n">comments</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Sorry, the grammar isn&#39;t perfect: require a newline for rules</span>
        <span class="n">pvlist</span><span class="p">:</span> <span class="n">PVList</span> <span class="o">=</span> <span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">contents</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">pvlist</span><span class="o">.</span><span class="n">comments</span> <span class="o">=</span> <span class="n">comments</span>
        <span class="k">return</span> <span class="n">pvlist</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load a PVList from a file object.&quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">fp</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Load a PVList from a filename.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_file_obj</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="p">))</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">













<h6 id="whatrecord.gateway.PVList-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.gateway.PVList.find" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">PVList</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">whatrecord</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">Rule</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Yield matching rule types.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Rule</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Yield matching rule types.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">rule</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.gateway.PVList.from_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">PVList</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">])</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a PVList from a filename.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Load a PVList from a filename.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_file_obj</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.gateway.PVList.from_file_obj" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">PVList</span><span class="o">.</span><span class="n">from_file_obj</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a PVList from a file object.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load a PVList from a file object.&quot;&quot;&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">fp</span><span class="p">)))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.gateway.PVList.match" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">PVList</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">whatrecord</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">Rule</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Yield matching rules.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">match</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Rule</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Yield matching rules.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">rule</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.gateway.PVListMatch" class="doc doc-heading">
        <code>
whatrecord.gateway.PVListMatch        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>PVListMatch(filename: str, rule: whatrecord.gateway.Rule, groups: List[str])</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PVListMatch</span><span class="p">:</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">rule</span><span class="p">:</span> <span class="n">Rule</span>
    <span class="n">groups</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.gateway.PVListMatches" class="doc doc-heading">
        <code>
whatrecord.gateway.PVListMatches        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>PVListMatches(name: str, matches: List[whatrecord.gateway.PVListMatch])</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PVListMatches</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">matches</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PVListMatch</span><span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.gateway.Rule" class="doc doc-heading">
        <code>
whatrecord.gateway.Rule        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>A PVList rule (base class).</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Rule</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A PVList rule (base class).&quot;&quot;&quot;</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">pattern</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">command</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Pattern</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">apischema</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">skip</span>
    <span class="p">)</span>
    <span class="n">header</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid regex. </span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Match a pv name against this rule.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">













<h6 id="whatrecord.gateway.Rule-methods">Methods</h6>





  <div class="doc doc-object doc-method">



<h7 id="whatrecord.gateway.Rule.match" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">Rule</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Match a pv name against this rule.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Match a pv name against this rule.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>


<h4 id="whatrecord.gateway-functions">Functions</h4>

  <div class="doc doc-object doc-function">



<h5 id="whatrecord.gateway.create_arg_parser" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">create_arg_parser</span><span class="p">()</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Create the argument parser.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/gateway.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_arg_parser</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Create the argument parser.&quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;pvlist name matching and linting tool&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--lint&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Lint regular expressions&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--pvlists&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specific pvlists to check (empty for all)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--hide-context&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Hide comment context&quot;</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--remove-any&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Remove &#39;.*&#39; from results&quot;</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;PV names to match&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="whatrecord.snl" class="doc doc-heading">
        <code>whatrecord.snl</code>



</h3>

    <div class="doc doc-contents first">




  <div class="doc doc-children">







<h4 id="whatrecord.snl-classes">Classes</h4>

  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.AbstractDeclarator" class="doc doc-heading">
        <code>
whatrecord.snl.AbstractDeclarator        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>AbstractDeclarator(context: 'FullLoadContext', params: 'Optional[Sequence[ParameterDeclarator]]' = None, subscript: 'Optional[str]' = None, inner_decl: 'Optional[AbstractDeclarator]' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AbstractDeclarator</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">ParameterDeclarator</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">subscript</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">inner_decl</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AbstractDeclarator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_decl</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_decl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subscript</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">subscript</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="n">prefix</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">



















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.AbstractDeclaratorModifier" class="doc doc-heading">
        <code>
whatrecord.snl.AbstractDeclaratorModifier        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>AbstractDeclaratorModifier(context: 'FullLoadContext', modifier: 'str', decl: 'Optional[AbstractDeclarator]' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AbstractDeclaratorModifier</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">modifier</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">decl</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AbstractDeclarator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modifier</span> <span class="o">==</span> <span class="s2">&quot;(&quot;</span><span class="p">:</span>  <span class="c1"># )</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">decl</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modifier</span> <span class="o">==</span> <span class="s2">&quot;*&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">decl</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">modifier</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">decl</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Assignment" class="doc doc-heading">
        <code>
whatrecord.snl.Assignment            (<a title="whatrecord.snl.Definition" href="#whatrecord.snl.Definition">Definition</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Assignment(context: 'FullLoadContext', variable: 'str', value: 'Optional[Union[str, Sequence[str]]]' = None, subscript: 'Optional[str]' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Assignment</span><span class="p">(</span><span class="n">Definition</span><span class="p">):</span>
    <span class="n">variable</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">subscript</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;{ &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">subscript</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.BinaryOperatorExpression" class="doc doc-heading">
        <code>
whatrecord.snl.BinaryOperatorExpression            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>BinaryOperatorExpression(context: 'FullLoadContext', left: 'Expression', operator: 'str', right: 'Expression')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">BinaryOperatorExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">left</span><span class="p">:</span> <span class="n">Expression</span>
    <span class="n">operator</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">right</span><span class="p">:</span> <span class="n">Expression</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Block" class="doc doc-heading">
        <code>
whatrecord.snl.Block        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Block(context: 'FullLoadContext', definitions: 'Sequence[Definition]' = <factory>, statements: 'Sequence[Statement]' = <factory>)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Block</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">definitions</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Definition</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">statements</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Statement</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">definitions</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">defn</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">defn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span>
            <span class="p">),</span>
            <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;    &quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">statements</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">statements</span>
            <span class="p">),</span>
            <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;    &quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="s2">&quot;{&quot;</span><span class="p">,</span>
                <span class="n">definitions</span><span class="p">,</span>
                <span class="n">statements</span><span class="p">,</span>
                <span class="s2">&quot;}&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.BracketedExpression" class="doc doc-heading">
        <code>
whatrecord.snl.BracketedExpression            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>BracketedExpression(context: 'FullLoadContext', outer: 'Expression', inner: 'Expression')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">BracketedExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">outer</span><span class="p">:</span> <span class="n">Expression</span>
    <span class="n">inner</span><span class="p">:</span> <span class="n">Expression</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">outer</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">inner</span><span class="si">}</span><span class="s2">]&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.BreakStatement" class="doc doc-heading">
        <code>
whatrecord.snl.BreakStatement            (<a title="whatrecord.snl.Statement" href="#whatrecord.snl.Statement">Statement</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>BreakStatement(context: 'FullLoadContext')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">BreakStatement</span><span class="p">(</span><span class="n">Statement</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;break;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.CCode" class="doc doc-heading">
        <code>
whatrecord.snl.CCode            (<a title="whatrecord.snl.Definition" href="#whatrecord.snl.Definition">Definition</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>CCode(context: 'FullLoadContext', code: 'str')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">CCode</span><span class="p">(</span><span class="n">Definition</span><span class="p">):</span>
    <span class="n">code</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.CommaSeparatedExpressions" class="doc doc-heading">
        <code>
whatrecord.snl.CommaSeparatedExpressions            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>CommaSeparatedExpressions(context: 'FullLoadContext', expressions: 'List[Expression]')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">CommaSeparatedExpressions</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">expressions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Expression</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expressions</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.ContinueStatement" class="doc doc-heading">
        <code>
whatrecord.snl.ContinueStatement            (<a title="whatrecord.snl.Statement" href="#whatrecord.snl.Statement">Statement</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ContinueStatement(context: 'FullLoadContext')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ContinueStatement</span><span class="p">(</span><span class="n">Statement</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;continue;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Declaration" class="doc doc-heading">
        <code>
whatrecord.snl.Declaration            (<a title="whatrecord.snl.Definition" href="#whatrecord.snl.Definition">Definition</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Declaration(context: 'FullLoadContext', type: 'Optional[Type]' = None, declarators: 'Optional[Sequence[Declarator]]' = <factory>)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Declaration</span><span class="p">(</span><span class="n">Definition</span><span class="p">):</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">declarators</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Declarator</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">declarators</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">decl</span><span class="p">)</span> <span class="k">for</span> <span class="n">decl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">declarators</span> <span class="ow">or</span> <span class="p">[])</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">declarators</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Declarator" class="doc doc-heading">
        <code>
whatrecord.snl.Declarator        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Declarator(context: 'FullLoadContext', object: 'Union[Declarator, Variable]', params: 'Optional[List[ParameterDeclarator]]' = None, value: 'Optional[Expression]' = None, modifier: 'Optional[str]' = None, subscript: 'Optional[int]' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Declarator</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="nb">object</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Declarator</span><span class="p">,</span> <span class="n">Variable</span><span class="p">]</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ParameterDeclarator</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Expression</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">modifier</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">subscript</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modifier</span> <span class="o">==</span> <span class="s2">&quot;()&quot;</span><span class="p">:</span>
            <span class="n">decl</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">modifier</span><span class="p">:</span>
            <span class="n">decl</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">modifier</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">subscript</span><span class="p">:</span>
            <span class="n">decl</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">subscript</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
            <span class="n">decl</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">decl</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">decl</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">decl</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">





















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Definition" class="doc doc-heading">
        <code>
whatrecord.snl.Definition        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Definition(context: 'FullLoadContext')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Definition</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.ExitExpression" class="doc doc-heading">
        <code>
whatrecord.snl.ExitExpression            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ExitExpression(context: 'FullLoadContext', args: 'OptionalExpression')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ExitExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">OptionalExpression</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;exit(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.ExitTransition" class="doc doc-heading">
        <code>
whatrecord.snl.ExitTransition            (<a title="whatrecord.snl.Transition" href="#whatrecord.snl.Transition">Transition</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ExitTransition(context: 'FullLoadContext', block: 'Block', target_state: 'Optional[str]' = None, condition: 'OptionalExpression' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ExitTransition</span><span class="p">(</span><span class="n">Transition</span><span class="p">):</span>
    <span class="o">...</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Expression" class="doc doc-heading">
        <code>
whatrecord.snl.Expression        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Expression(context: 'FullLoadContext')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Expression</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.ExpressionStatement" class="doc doc-heading">
        <code>
whatrecord.snl.ExpressionStatement            (<a title="whatrecord.snl.Statement" href="#whatrecord.snl.Statement">Statement</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ExpressionStatement(context: 'FullLoadContext', expression: 'CommaSeparatedExpressions')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ExpressionStatement</span><span class="p">(</span><span class="n">Statement</span><span class="p">):</span>
    <span class="n">expression</span><span class="p">:</span> <span class="n">CommaSeparatedExpressions</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.ExpressionWithArguments" class="doc doc-heading">
        <code>
whatrecord.snl.ExpressionWithArguments            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ExpressionWithArguments(context: 'FullLoadContext', expression: 'Expression', arguments: 'OptionalExpression' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ExpressionWithArguments</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">expression</span><span class="p">:</span> <span class="n">Expression</span>
    <span class="n">arguments</span><span class="p">:</span> <span class="n">OptionalExpression</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">arguments</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.ForStatement" class="doc doc-heading">
        <code>
whatrecord.snl.ForStatement            (<a title="whatrecord.snl.Statement" href="#whatrecord.snl.Statement">Statement</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ForStatement(context: 'FullLoadContext', init: 'OptionalExpression', condition: 'OptionalExpression', increment: 'OptionalExpression', statement: 'Statement')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ForStatement</span><span class="p">(</span><span class="n">Statement</span><span class="p">):</span>
    <span class="n">init</span><span class="p">:</span> <span class="n">OptionalExpression</span>
    <span class="n">condition</span><span class="p">:</span> <span class="n">OptionalExpression</span>
    <span class="n">increment</span><span class="p">:</span> <span class="n">OptionalExpression</span>
    <span class="n">statement</span><span class="p">:</span> <span class="n">Statement</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;for (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">init</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">increment</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">) &quot;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">statement</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">



















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.ForeignDeclaration" class="doc doc-heading">
        <code>
whatrecord.snl.ForeignDeclaration            (<a title="whatrecord.snl.Declaration" href="#whatrecord.snl.Declaration">Declaration</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ForeignDeclaration(context: 'FullLoadContext', type: 'Optional[Type]' = None, declarators: 'Optional[Sequence[Declarator]]' = <factory>, names: 'Sequence[str]' = <factory>)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ForeignDeclaration</span><span class="p">(</span><span class="n">Declaration</span><span class="p">):</span>
    <span class="n">names</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;foreign </span><span class="si">{</span><span class="n">names</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.FuncDef" class="doc doc-heading">
        <code>
whatrecord.snl.FuncDef            (<a title="whatrecord.snl.Definition" href="#whatrecord.snl.Definition">Definition</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>FuncDef(context: 'FullLoadContext', type: 'Type', declarator: 'Declarator', block: 'Block')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">FuncDef</span><span class="p">(</span><span class="n">Definition</span><span class="p">):</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Type</span>
    <span class="n">declarator</span><span class="p">:</span> <span class="n">Declarator</span>
    <span class="n">block</span><span class="p">:</span> <span class="n">Block</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">declarator</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.IfStatement" class="doc doc-heading">
        <code>
whatrecord.snl.IfStatement            (<a title="whatrecord.snl.Statement" href="#whatrecord.snl.Statement">Statement</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>IfStatement(context: 'FullLoadContext', condition: 'CommaSeparatedExpressions', body: 'Statement', else_body: 'Optional[Statement]' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">IfStatement</span><span class="p">(</span><span class="n">Statement</span><span class="p">):</span>
    <span class="n">condition</span><span class="p">:</span> <span class="n">CommaSeparatedExpressions</span>
    <span class="n">body</span><span class="p">:</span> <span class="n">Statement</span>
    <span class="n">else_body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Statement</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">else_clause</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">else {&quot;</span><span class="p">,</span>
                <span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">else_body</span><span class="p">),</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s2">&quot;}&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">else_body</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;if (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="si">}</span><span class="s2">) &quot;</span> <span class="o">+</span> <span class="s2">&quot; {&quot;</span><span class="p">,</span>
                <span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">),</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
                <span class="n">else_clause</span><span class="p">,</span>
                <span class="s2">&quot;}&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.InitExpression" class="doc doc-heading">
        <code>
whatrecord.snl.InitExpression            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Of the form:</p>
<p>( type ) { init_exprs }
{ init_exprs }
expr</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">InitExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Of the form:</span>
<span class="sd">        ( type ) { init_exprs }</span>
<span class="sd">        { init_exprs }</span>
<span class="sd">        expr</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO: may be improved?</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">expressions</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">InitExpression</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span>
    <span class="p">)</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">exprs</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">expr</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expressions</span><span class="p">)</span>
        <span class="n">type_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">) &quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">type_prefix</span><span class="si">}</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="n">exprs</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Literal" class="doc doc-heading">
        <code>
whatrecord.snl.Literal            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Literal(context: 'FullLoadContext', type: 'str', value: 'str')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Literal</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.MemberExpression" class="doc doc-heading">
        <code>
whatrecord.snl.MemberExpression            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>MemberExpression(context: 'FullLoadContext', parent: 'Expression', member: 'str', dereference: 'bool')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">MemberExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">parent</span><span class="p">:</span> <span class="n">Expression</span>
    <span class="n">member</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">dereference</span><span class="p">:</span> <span class="nb">bool</span>  <span class="c1"># True = -&gt;, False = .</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="si">}</span><span class="s2">-&gt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Monitor" class="doc doc-heading">
        <code>
whatrecord.snl.Monitor            (<a title="whatrecord.snl.Definition" href="#whatrecord.snl.Definition">Definition</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Monitor(context: 'FullLoadContext', variable: 'str', subscript: 'Optional[int]')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Monitor</span><span class="p">(</span><span class="n">Definition</span><span class="p">):</span>
    <span class="n">variable</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">subscript</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;monitor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">subscript</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Option" class="doc doc-heading">
        <code>
whatrecord.snl.Option            (<a title="whatrecord.snl.Definition" href="#whatrecord.snl.Definition">Definition</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Option(context: 'FullLoadContext', name: 'str', enable: 'bool')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Option</span><span class="p">(</span><span class="n">Definition</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">enable</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">plus</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;option </span><span class="si">{</span><span class="n">plus</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.ParameterDeclarator" class="doc doc-heading">
        <code>
whatrecord.snl.ParameterDeclarator        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ParameterDeclarator(context: 'FullLoadContext', type: 'Type', declarator: 'Optional[Declarator]' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ParameterDeclarator</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Type</span>
    <span class="n">declarator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Declarator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">declarator</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">declarator</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.ParenthesisExpression" class="doc doc-heading">
        <code>
whatrecord.snl.ParenthesisExpression            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ParenthesisExpression(context: 'FullLoadContext', expression: 'Expression')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ParenthesisExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">expression</span><span class="p">:</span> <span class="n">Expression</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.ReturnStatement" class="doc doc-heading">
        <code>
whatrecord.snl.ReturnStatement            (<a title="whatrecord.snl.Statement" href="#whatrecord.snl.Statement">Statement</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ReturnStatement(context: 'FullLoadContext', value: 'Optional[Expression]' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ReturnStatement</span><span class="p">(</span><span class="n">Statement</span><span class="p">):</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Expression</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;return </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;return;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.SequencerProgram" class="doc doc-heading">
        <code>
whatrecord.snl.SequencerProgram        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Representation of a state notation language (snl seq) program.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">SequencerProgram</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Representation of a state notation language (snl seq) program.&quot;&quot;&quot;</span>

    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">initial_definitions</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Definition</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">entry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Block</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">state_sets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">StateSet</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">exit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Block</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">final_definitions</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Definition</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">initial_definitions</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">defn</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">defn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_definitions</span>
        <span class="p">)</span>
        <span class="n">final_definitions</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">defn</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">defn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_definitions</span>
        <span class="p">)</span>
        <span class="n">state_sets</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">state_set</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">state_set</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_sets</span>
        <span class="p">)</span>
        <span class="n">param</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;program </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="n">param</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">initial_definitions</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                <span class="n">state_sets</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exit</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                <span class="n">final_definitions</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">line</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">search_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Preprocess the given sequencer code, expanding #include.&quot;&quot;&quot;</span>
        <span class="c1"># Line numbers will be off with this, sadly</span>
        <span class="c1"># The sequencer itself gets around this by using LINE_MARKER tokens</span>
        <span class="c1"># to indicate what file and line the code came from.  This could</span>
        <span class="c1"># be something we support in the future, but it might not be easy</span>
        <span class="c1"># with lark...</span>
        <span class="n">search_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span> <span class="k">if</span> <span class="n">search_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">search_path</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">([(</span><span class="n">search_path</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">code</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()])</span>
        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
            <span class="n">search_path</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#include&quot;</span><span class="p">):</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">include_file</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">include_file</span> <span class="o">=</span> <span class="p">(</span><span class="n">search_path</span> <span class="o">/</span> <span class="n">include_file</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">include_file</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                    <span class="n">stack</span><span class="o">.</span><span class="n">extendleft</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="p">(</span><span class="n">include_file</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())</span>
                        <span class="p">]</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#if&quot;</span><span class="p">):</span>
                <span class="o">...</span>  <span class="c1"># sorry; this may break things</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#else&quot;</span><span class="p">):</span>
                <span class="o">...</span>  <span class="c1"># sorry; this may break things</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#elif&quot;</span><span class="p">):</span>
                <span class="o">...</span>  <span class="c1"># sorry; this may break things</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#endif&quot;</span><span class="p">):</span>
                <span class="o">...</span>  <span class="c1"># sorry; this may break things</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#define&quot;</span><span class="p">):</span>
                <span class="k">while</span> <span class="n">stack</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">):</span>
                    <span class="n">search_path</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

                <span class="o">...</span>  <span class="c1"># sorry; I think we can do better</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgram</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load a state notation language file given its string contents.&quot;&quot;&quot;</span>
        <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
            <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
            <span class="s2">&quot;snl.lark&quot;</span><span class="p">,</span>
            <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,),</span>
            <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;earley&quot;</span><span class="p">,</span>
            <span class="c1"># TODO: alternative comment finding method</span>
            <span class="c1"># lexer_callbacks={&quot;COMMENT&quot;: comments.append},</span>
            <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">propagate_positions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">search_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">search_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span>

        <span class="n">preprocessed</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="n">search_path</span><span class="o">=</span><span class="n">search_path</span><span class="p">)</span>
        <span class="n">proto</span> <span class="o">=</span> <span class="n">_ProgramTransformer</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
            <span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">preprocessed</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">proto</span><span class="o">.</span><span class="n">comments</span> <span class="o">=</span> <span class="n">comments</span>
        <span class="k">return</span> <span class="n">proto</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgram</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load a state notation language program given a file object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgram</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load a state notation language file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : pathlib.Path or str</span>
<span class="sd">            The filename.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        program : SequencerProgram</span>
<span class="sd">            The parsed program.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">fn</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">as_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgramGraph</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a graphviz digraph of the state notation diagram.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        graph : SequencerProgramGraph</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">SequencerProgramGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">















<h6 id="whatrecord.snl.SequencerProgram-methods">Methods</h6>





  <div class="doc doc-object doc-method">



<h7 id="whatrecord.snl.SequencerProgram.as_graph" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">snl</span><span class="o">.</span><span class="n">SequencerProgram</span><span class="o">.</span><span class="n">as_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgramGraph</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Create a graphviz digraph of the state notation diagram.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">as_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgramGraph</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a graphviz digraph of the state notation diagram.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    graph : SequencerProgramGraph</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">SequencerProgramGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.snl.SequencerProgram.from_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">snl</span><span class="o">.</span><span class="n">SequencerProgram</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgram</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a state notation language file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>pathlib.Path or str</code></td>
        <td><p>The filename.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>SequencerProgram</code></td>
      <td><p>The parsed program.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgram</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a state notation language file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : pathlib.Path or str</span>
<span class="sd">        The filename.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    program : SequencerProgram</span>
<span class="sd">        The parsed program.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">fn</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.snl.SequencerProgram.from_file_obj" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">snl</span><span class="o">.</span><span class="n">SequencerProgram</span><span class="o">.</span><span class="n">from_file_obj</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgram</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a state notation language program given a file object.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgram</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load a state notation language program given a file object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
        <span class="n">filename</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.snl.SequencerProgram.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">snl</span><span class="o">.</span><span class="n">SequencerProgram</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgram</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a state notation language file given its string contents.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequencerProgram</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load a state notation language file given its string contents.&quot;&quot;&quot;</span>
    <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
        <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
        <span class="s2">&quot;snl.lark&quot;</span><span class="p">,</span>
        <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,),</span>
        <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;earley&quot;</span><span class="p">,</span>
        <span class="c1"># TODO: alternative comment finding method</span>
        <span class="c1"># lexer_callbacks={&quot;COMMENT&quot;: comments.append},</span>
        <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">propagate_positions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">search_path</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">search_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span>

    <span class="n">preprocessed</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="n">search_path</span><span class="o">=</span><span class="n">search_path</span><span class="p">)</span>
    <span class="n">proto</span> <span class="o">=</span> <span class="n">_ProgramTransformer</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
        <span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">preprocessed</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">proto</span><span class="o">.</span><span class="n">comments</span> <span class="o">=</span> <span class="n">comments</span>
    <span class="k">return</span> <span class="n">proto</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.snl.SequencerProgram.preprocess" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">snl</span><span class="o">.</span><span class="n">SequencerProgram</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">search_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Preprocess the given sequencer code, expanding #include.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">search_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Preprocess the given sequencer code, expanding #include.&quot;&quot;&quot;</span>
    <span class="c1"># Line numbers will be off with this, sadly</span>
    <span class="c1"># The sequencer itself gets around this by using LINE_MARKER tokens</span>
    <span class="c1"># to indicate what file and line the code came from.  This could</span>
    <span class="c1"># be something we support in the future, but it might not be easy</span>
    <span class="c1"># with lark...</span>
    <span class="n">search_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span> <span class="k">if</span> <span class="n">search_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">search_path</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">([(</span><span class="n">search_path</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">code</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()])</span>
    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
        <span class="n">search_path</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#include&quot;</span><span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">include_file</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">include_file</span> <span class="o">=</span> <span class="p">(</span><span class="n">search_path</span> <span class="o">/</span> <span class="n">include_file</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">include_file</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">extendleft</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">(</span><span class="n">include_file</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())</span>
                    <span class="p">]</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#if&quot;</span><span class="p">):</span>
            <span class="o">...</span>  <span class="c1"># sorry; this may break things</span>
        <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#else&quot;</span><span class="p">):</span>
            <span class="o">...</span>  <span class="c1"># sorry; this may break things</span>
        <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#elif&quot;</span><span class="p">):</span>
            <span class="o">...</span>  <span class="c1"># sorry; this may break things</span>
        <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#endif&quot;</span><span class="p">):</span>
            <span class="o">...</span>  <span class="c1"># sorry; this may break things</span>
        <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#define&quot;</span><span class="p">):</span>
            <span class="k">while</span> <span class="n">stack</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">):</span>
                <span class="n">search_path</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

            <span class="o">...</span>  <span class="c1"># sorry; I think we can do better</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.SequencerProgramGraph" class="doc doc-heading">
        <code>
whatrecord.snl.SequencerProgramGraph            (<span title="whatrecord.graph._GraphHelper">_GraphHelper</span>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>A graph for a SequencerProgram.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>program</code></td>
        <td><code>Optional[SequencerProgram]</code></td>
        <td><p>A program to add.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>highlight_states</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>List of state names to highlight.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>include_code</code></td>
        <td><code>bool</code></td>
        <td><p>Include code, where relevant, in nodes.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">SequencerProgramGraph</span><span class="p">(</span><span class="n">_GraphHelper</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A graph for a SequencerProgram.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    program : SequencerProgram, optional</span>
<span class="sd">        A program to add.</span>

<span class="sd">    highlight_states : list of str, optional</span>
<span class="sd">        List of state names to highlight.</span>

<span class="sd">    include_code : bool, optional</span>
<span class="sd">        Include code, where relevant, in nodes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_entry_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_Entry_&quot;</span>
    <span class="n">_exit_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_Exit_&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">program</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SequencerProgram</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">highlight_states</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">include_code</span> <span class="o">=</span> <span class="n">include_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlight_states</span> <span class="o">=</span> <span class="n">highlight_states</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">program</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_program</span><span class="p">(</span><span class="n">program</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_program</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">program</span><span class="p">:</span> <span class="n">SequencerProgram</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a program to the graph.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">state_set</span> <span class="ow">in</span> <span class="n">program</span><span class="o">.</span><span class="n">state_sets</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">state_set</span><span class="o">.</span><span class="n">states</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_state</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">state_set</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="c1"># Only add entry/exit labels if there&#39;s an edge</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_entry_label</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_code</span><span class="p">(</span><span class="n">program</span><span class="o">.</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;(Startup)&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_label</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_code</span><span class="p">(</span><span class="n">program</span><span class="o">.</span><span class="n">exit</span><span class="p">,</span> <span class="s2">&quot;(Exit)&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">program</span><span class="p">:</span> <span class="n">SequencerProgram</span><span class="p">,</span> <span class="n">state_set</span><span class="p">:</span> <span class="n">StateSet</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a state set&#39;s state to the graph.&quot;&quot;&quot;</span>
        <span class="n">qualified_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state_set</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span>
            <span class="n">qualified_name</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_state_node_text</span><span class="p">(</span><span class="n">state_set</span><span class="p">,</span> <span class="n">state</span><span class="p">)),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">state_set</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">state</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_entry_label</span><span class="p">,</span>
                <span class="n">qualified_name</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">transition</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">transitions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_transition</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">state_set</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">transition</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">transition</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">code_transitions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span>
                <span class="n">qualified_name</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state_set</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">transition</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;(Line </span><span class="si">{</span><span class="n">transition</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">line</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ready_for_digraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">gv</span><span class="o">.</span><span class="n">Digraph</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hook when the user calls ``to_digraph``.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">node</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">highlight_states</span>

    <span class="k">def</span> <span class="nf">_add_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">program</span><span class="p">:</span> <span class="n">SequencerProgram</span><span class="p">,</span>
        <span class="n">state_set</span><span class="p">:</span> <span class="n">StateSet</span><span class="p">,</span>
        <span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">,</span>
        <span class="n">transition</span><span class="p">:</span> <span class="n">Transition</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a state set&#39;s state transition to the graph.&quot;&quot;&quot;</span>
        <span class="n">state_qualified_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state_set</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">condition</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">transition_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_code</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">block</span><span class="p">)</span>
        <span class="n">target_state</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state_set</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">transition</span><span class="o">.</span><span class="n">target_state</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">transition</span><span class="o">.</span><span class="n">target_state</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_label</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_code</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">transition_text</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">state_qualified_name</span><span class="p">,</span> <span class="n">target_state</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">transition_idx</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">transitions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">transition</span><span class="p">)</span>
        <span class="n">transition_node</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state_qualified_name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">transition_idx</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">transition_node</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">transition_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">state_qualified_name</span><span class="p">,</span> <span class="n">transition_node</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">transition_node</span><span class="p">,</span> <span class="n">target_state</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get code for a node/edge.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_code</span> <span class="ow">and</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clean_code</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span> <span class="ow">or</span> <span class="n">default</span>
        <span class="k">return</span> <span class="n">default</span>

    <span class="k">def</span> <span class="nf">_get_state_node_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_set</span><span class="p">:</span> <span class="n">StateSet</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">):</span>
        <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;</span><span class="si">{</span><span class="n">state_set</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&lt;/b&gt;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_code</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">yield</span> <span class="s2">&quot;&lt;u&gt;Entry&lt;/u&gt;&quot;</span>
                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">clean_code</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">exit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">yield</span> <span class="s2">&quot;&lt;u&gt;Exit&lt;/u&gt;&quot;</span>
                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">clean_code</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">exit</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">







<h6 id="whatrecord.snl.SequencerProgramGraph-methods">Methods</h6>


  <div class="doc doc-object doc-method">



<h7 id="whatrecord.snl.SequencerProgramGraph.add_program" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">snl</span><span class="o">.</span><span class="n">SequencerProgramGraph</span><span class="o">.</span><span class="n">add_program</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">program</span><span class="p">:</span> <span class="n">SequencerProgram</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Add a program to the graph.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_program</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">program</span><span class="p">:</span> <span class="n">SequencerProgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a program to the graph.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">state_set</span> <span class="ow">in</span> <span class="n">program</span><span class="o">.</span><span class="n">state_sets</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">state_set</span><span class="o">.</span><span class="n">states</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_state</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">state_set</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

    <span class="c1"># Only add entry/exit labels if there&#39;s an edge</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_label</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_code</span><span class="p">(</span><span class="n">program</span><span class="o">.</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;(Startup)&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit_label</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_code</span><span class="p">(</span><span class="n">program</span><span class="o">.</span><span class="n">exit</span><span class="p">,</span> <span class="s2">&quot;(Exit)&quot;</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.snl.SequencerProgramGraph.get_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">snl</span><span class="o">.</span><span class="n">SequencerProgramGraph</span><span class="o">.</span><span class="n">get_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Get code for a node/edge.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get code for a node/edge.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_code</span> <span class="ow">and</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clean_code</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span> <span class="ow">or</span> <span class="n">default</span>
    <span class="k">return</span> <span class="n">default</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.SizeofExpression" class="doc doc-heading">
        <code>
whatrecord.snl.SizeofExpression            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>SizeofExpression(context: 'FullLoadContext', type: 'Type')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">SizeofExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Type</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;sizeof(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.State" class="doc doc-heading">
        <code>
whatrecord.snl.State        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>State(context: 'FullLoadContext', name: 'str', definitions: 'Sequence[Definition]' = <factory>, transitions: 'Sequence[Transition]' = <factory>, entry: 'Optional[Block]' = None, exit: 'Optional[Block]' = None, code_transitions: 'List[StateStatement]' = <factory>)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">State</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">definitions</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Definition</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">transitions</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Transition</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">entry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Block</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">exit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Block</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">code_transitions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">StateStatement</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">definitions</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">defn</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">defn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span>
        <span class="p">)</span>
        <span class="n">transitions</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">transition</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">transition</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transitions</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;state </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; {&quot;</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                <span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="n">definitions</span><span class="p">,</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
                <span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="n">transitions</span><span class="p">,</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exit</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                <span class="s2">&quot;}&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">line</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.StateSet" class="doc doc-heading">
        <code>
whatrecord.snl.StateSet        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>StateSet(context: 'FullLoadContext', name: 'str', definitions: 'Sequence[Definition]' = <factory>, states: 'Sequence[State]' = <factory>)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">StateSet</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">definitions</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Definition</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">states</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">State</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">definitions</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">defn</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">defn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span>
        <span class="p">)</span>
        <span class="n">states</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;ss </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; {&quot;</span><span class="p">,</span>
                <span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="n">definitions</span><span class="p">,</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
                <span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s2">&quot;}&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">



















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.StateStatement" class="doc doc-heading">
        <code>
whatrecord.snl.StateStatement            (<a title="whatrecord.snl.Statement" href="#whatrecord.snl.Statement">Statement</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>StateStatement(context: 'FullLoadContext', name: 'str')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">StateStatement</span><span class="p">(</span><span class="n">Statement</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;state </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Statement" class="doc doc-heading">
        <code>
whatrecord.snl.Statement        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Statement(context: 'FullLoadContext')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Statement</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.StructDef" class="doc doc-heading">
        <code>
whatrecord.snl.StructDef            (<a title="whatrecord.snl.Definition" href="#whatrecord.snl.Definition">Definition</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>StructDef(context: 'FullLoadContext', name: 'str', members: 'Sequence[Union[StructMemberDecl, CCode]]' = <factory>)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">StructDef</span><span class="p">(</span><span class="n">Definition</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">members</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">StructMemberDecl</span><span class="p">,</span> <span class="n">CCode</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">members</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">member</span><span class="p">)</span> <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;struct </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; {&quot;</span><span class="p">,</span>
                <span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="n">members</span><span class="p">,</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s2">&quot;}&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.StructMemberDecl" class="doc doc-heading">
        <code>
whatrecord.snl.StructMemberDecl        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>StructMemberDecl(context: 'FullLoadContext', type: 'Type', declarator: 'Declarator')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">StructMemberDecl</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Type</span>
    <span class="n">declarator</span><span class="p">:</span> <span class="n">Declarator</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">declarator</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Sync" class="doc doc-heading">
        <code>
whatrecord.snl.Sync            (<a title="whatrecord.snl.Definition" href="#whatrecord.snl.Definition">Definition</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Sync(context: 'FullLoadContext', variable: 'str', subscript: 'Optional[int]', queued: 'bool', event_flag: 'Optional[str]' = None, queue_size: 'Optional[int]' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Sync</span><span class="p">(</span><span class="n">Definition</span><span class="p">):</span>
    <span class="n">variable</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">subscript</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">queued</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">event_flag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">queue_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">subscript</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subscript</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">variable</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="si">}{</span><span class="n">subscript</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">event_flag</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">event_flag</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_flag</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">queued</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;syncq </span><span class="si">{</span><span class="n">variable</span><span class="si">}{</span><span class="n">event_flag</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_size</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">;&quot;</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;sync </span><span class="si">{</span><span class="n">variable</span><span class="si">}{</span><span class="n">event_flag</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">




















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.TernaryExpression" class="doc doc-heading">
        <code>
whatrecord.snl.TernaryExpression            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>TernaryExpression(context: 'FullLoadContext', condition: 'Expression', if_true: 'Expression', if_false: 'Expression')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TernaryExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">condition</span><span class="p">:</span> <span class="n">Expression</span>
    <span class="n">if_true</span><span class="p">:</span> <span class="n">Expression</span>
    <span class="n">if_false</span><span class="p">:</span> <span class="n">Expression</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="si">}</span><span class="s2"> ? </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">if_true</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">if_false</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Transition" class="doc doc-heading">
        <code>
whatrecord.snl.Transition        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Transition(context: 'FullLoadContext', block: 'Block', target_state: 'Optional[str]' = None, condition: 'OptionalExpression' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Transition</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">block</span><span class="p">:</span> <span class="n">Block</span>
    <span class="n">target_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">condition</span><span class="p">:</span> <span class="n">OptionalExpression</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;state </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_state</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_state</span>
            <span class="k">else</span>
            <span class="s2">&quot;exit&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;when (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="o">+</span> <span class="s2">&quot; {&quot;</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block</span><span class="p">),</span>
                <span class="s2">&quot;}&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">line</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">



















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Type" class="doc doc-heading">
        <code>
whatrecord.snl.Type        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Type(context: 'FullLoadContext', name: 'str', abstract: 'Optional[AbstractDeclarator]' = None)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Type</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">abstract</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AbstractDeclarator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">abstract</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.TypeCastExpression" class="doc doc-heading">
        <code>
whatrecord.snl.TypeCastExpression            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>TypeCastExpression(context: 'FullLoadContext', type: 'Type', expression: 'Expression')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TypeCastExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Type</span>
    <span class="n">expression</span><span class="p">:</span> <span class="n">Expression</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.UnaryPostfixExpression" class="doc doc-heading">
        <code>
whatrecord.snl.UnaryPostfixExpression            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>UnaryPostfixExpression(context: 'FullLoadContext', expression: 'Expression', operator: 'str')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">UnaryPostfixExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">expression</span><span class="p">:</span> <span class="n">Expression</span>
    <span class="n">operator</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.UnaryPrefixExpression" class="doc doc-heading">
        <code>
whatrecord.snl.UnaryPrefixExpression            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>UnaryPrefixExpression(context: 'FullLoadContext', operator: 'str', expression: 'Expression')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">UnaryPrefixExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">operator</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">expression</span><span class="p">:</span> <span class="n">Expression</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.Variable" class="doc doc-heading">
        <code>
whatrecord.snl.Variable            (<a title="whatrecord.snl.Expression" href="#whatrecord.snl.Expression">Expression</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Variable(context: 'FullLoadContext', name: 'str')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Variable</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.snl.WhileStatement" class="doc doc-heading">
        <code>
whatrecord.snl.WhileStatement            (<a title="whatrecord.snl.Statement" href="#whatrecord.snl.Statement">Statement</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>WhileStatement(context: 'FullLoadContext', condition: 'CommaSeparatedExpressions', body: 'Statement')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/snl.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">WhileStatement</span><span class="p">(</span><span class="n">Statement</span><span class="p">):</span>
    <span class="n">condition</span><span class="p">:</span> <span class="n">CommaSeparatedExpressions</span>
    <span class="n">body</span><span class="p">:</span> <span class="n">Statement</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;while (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="si">}</span><span class="s2">) &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="whatrecord.streamdevice" class="doc doc-heading">
        <code>whatrecord.streamdevice</code>



</h3>

    <div class="doc doc-contents first">




  <div class="doc doc-children">





<h4 id="whatrecord.streamdevice-classes">Classes</h4>

  <div class="doc doc-object doc-class">



<h5 id="whatrecord.streamdevice.Command" class="doc doc-heading">
        <code>
whatrecord.streamdevice.Command        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Command(name: 'str', arguments: 'List[str]')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Command</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">arguments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.streamdevice.ConfigurationSetting" class="doc doc-heading">
        <code>
whatrecord.streamdevice.ConfigurationSetting        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ConfigurationSetting(name: 'str', value: 'str')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ConfigurationSetting</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.streamdevice.HandlerDefinition" class="doc doc-heading">
        <code>
whatrecord.streamdevice.HandlerDefinition        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>HandlerDefinition(name: 'str', commands: 'List[Command]' = <factory>)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">HandlerDefinition</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">commands</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Command</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.streamdevice.ProtocolDefinition" class="doc doc-heading">
        <code>
whatrecord.streamdevice.ProtocolDefinition        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>ProtocolDefinition(context: 'FullLoadContext', name: 'str', handlers: 'Dict[str, HandlerDefinition]' = <factory>, variables: 'Dict[str, str]' = <factory>, commands: 'List[Command]' = <factory>, config: 'Dict[str, str]' = <factory>)</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ProtocolDefinition</span><span class="p">:</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">FullLoadContext</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">handlers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">HandlerDefinition</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">variables</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">commands</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Command</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">




















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.streamdevice.StreamDeviceState" class="doc doc-heading">
        <code>
whatrecord.streamdevice.StreamDeviceState            (<a title="whatrecord.common.ShellStateHandler" href="../utilities/#whatrecord.common.ShellStateHandler">ShellStateHandler</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>StreamDevice IOC shell state handler / container.</p>
<p>Contains hooks for StreamDevice-related commands and state information.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>protocols</code></td>
        <td><code>Dict[str, StreamProtocol]</code></td>
        <td><p>Loaded StreamDevice protocols by name.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">StreamDeviceState</span><span class="p">(</span><span class="n">ShellStateHandler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    StreamDevice IOC shell state handler / container.</span>

<span class="sd">    Contains hooks for StreamDevice-related commands and state information.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    protocols : Dict[str, StreamProtocol]</span>
<span class="sd">        Loaded StreamDevice protocols by name.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">metadata_key</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;streamdevice&quot;</span>
    <span class="n">protocols</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">StreamProtocol</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">find_streamdevice_protocol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">:</span>
        <span class="n">shell_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span>
        <span class="k">return</span> <span class="n">shell_state</span><span class="o">.</span><span class="n">_fix_path_with_search_list</span><span class="p">(</span>
            <span class="n">filename</span><span class="p">,</span>
            <span class="n">shell_state</span><span class="o">.</span><span class="n">paths_from_env_var</span><span class="p">(</span><span class="s2">&quot;STREAM_PROTOCOL_PATH&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_streamdevice_protocol</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load a StreamDevice protocol file.&quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_streamdevice_protocol</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocols</span><span class="p">:</span>
            <span class="n">shell_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span>
            <span class="n">fn</span><span class="p">,</span> <span class="n">contents</span> <span class="o">=</span> <span class="n">shell_state</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">protocols</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">StreamProtocol</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
                <span class="n">contents</span><span class="p">,</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">fn</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocols</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">annotate_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Hook to annotate a record after being loaded.&quot;&quot;&quot;</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DTYP&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dtype</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;stream&quot;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">info_field</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;INP&quot;</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;OUT&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">info_field</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">info_field</span><span class="p">,</span> <span class="n">PVAFieldReference</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;INP/OUT not defined correctly&quot;</span>
            <span class="p">}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">info_field</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;INP/OUT not defined correctly (JSON)&quot;</span>
            <span class="p">}</span>

        <span class="n">info_field</span> <span class="o">=</span> <span class="n">info_field</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">proto_file</span><span class="p">,</span> <span class="n">proto_name</span><span class="p">,</span> <span class="o">*</span><span class="n">proto_args</span> <span class="o">=</span> <span class="n">split_words</span><span class="p">(</span><span class="n">info_field</span><span class="p">)</span><span class="o">.</span><span class="n">argv</span>
            <span class="n">proto_file</span> <span class="o">=</span> <span class="n">proto_file</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;@ &quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid StreamDevice input/output field: </span><span class="si">{</span><span class="n">info_field</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">proto_file</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">proto_name</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">proto_args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">protocol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_streamdevice_protocol</span><span class="p">(</span><span class="n">proto_file</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">proto_name</span> <span class="ow">in</span> <span class="n">protocol</span><span class="o">.</span><span class="n">protocols</span><span class="p">:</span>
                    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;protocol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">protocol</span><span class="o">.</span><span class="n">protocols</span><span class="p">[</span><span class="n">proto_name</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Unknown protocol </span><span class="si">{</span><span class="n">proto_name</span><span class="si">!r}</span><span class="s2"> in </span><span class="si">{</span><span class="n">proto_file</span><span class="si">}</span><span class="s2">; &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;options are: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">protocol</span><span class="o">.</span><span class="n">protocols</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;protocol_file&quot;</span><span class="p">:</span> <span class="n">proto_file</span><span class="p">,</span>
            <span class="s2">&quot;protocol_name&quot;</span><span class="p">:</span> <span class="n">proto_name</span><span class="p">,</span>
            <span class="s2">&quot;protocol_args&quot;</span><span class="p">:</span> <span class="n">proto_args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">results</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









<h6 id="whatrecord.streamdevice.StreamDeviceState-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.streamdevice.StreamDeviceState.annotate_record" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">streamdevice</span><span class="o">.</span><span class="n">StreamDeviceState</span><span class="o">.</span><span class="n">annotate_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Hook to annotate a record after being loaded.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">annotate_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">RecordInstance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Hook to annotate a record after being loaded.&quot;&quot;&quot;</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DTYP&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">dtype</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;stream&quot;</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">info_field</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;INP&quot;</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;OUT&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">info_field</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">info_field</span><span class="p">,</span> <span class="n">PVAFieldReference</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;INP/OUT not defined correctly&quot;</span>
        <span class="p">}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">info_field</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;INP/OUT not defined correctly (JSON)&quot;</span>
        <span class="p">}</span>

    <span class="n">info_field</span> <span class="o">=</span> <span class="n">info_field</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">proto_file</span><span class="p">,</span> <span class="n">proto_name</span><span class="p">,</span> <span class="o">*</span><span class="n">proto_args</span> <span class="o">=</span> <span class="n">split_words</span><span class="p">(</span><span class="n">info_field</span><span class="p">)</span><span class="o">.</span><span class="n">argv</span>
        <span class="n">proto_file</span> <span class="o">=</span> <span class="n">proto_file</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;@ &quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid StreamDevice input/output field: </span><span class="si">{</span><span class="n">info_field</span><span class="si">!r}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">proto_file</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">proto_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">proto_args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">protocol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_streamdevice_protocol</span><span class="p">(</span><span class="n">proto_file</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proto_name</span> <span class="ow">in</span> <span class="n">protocol</span><span class="o">.</span><span class="n">protocols</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;protocol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">protocol</span><span class="o">.</span><span class="n">protocols</span><span class="p">[</span><span class="n">proto_name</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unknown protocol </span><span class="si">{</span><span class="n">proto_name</span><span class="si">!r}</span><span class="s2"> in </span><span class="si">{</span><span class="n">proto_file</span><span class="si">}</span><span class="s2">; &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;options are: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">protocol</span><span class="o">.</span><span class="n">protocols</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;protocol_file&quot;</span><span class="p">:</span> <span class="n">proto_file</span><span class="p">,</span>
        <span class="s2">&quot;protocol_name&quot;</span><span class="p">:</span> <span class="n">proto_name</span><span class="p">,</span>
        <span class="s2">&quot;protocol_args&quot;</span><span class="p">:</span> <span class="n">proto_args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">results</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.streamdevice.StreamDeviceState.load_streamdevice_protocol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">streamdevice</span><span class="o">.</span><span class="n">StreamDeviceState</span><span class="o">.</span><span class="n">load_streamdevice_protocol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span></code>


</h7>

    <div class="doc doc-contents ">

      <p>Load a StreamDevice protocol file.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load_streamdevice_protocol</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">AnyPath</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load a StreamDevice protocol file.&quot;&quot;&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_streamdevice_protocol</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocols</span><span class="p">:</span>
        <span class="n">shell_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_handler</span>
        <span class="n">fn</span><span class="p">,</span> <span class="n">contents</span> <span class="o">=</span> <span class="n">shell_state</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">protocols</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">StreamProtocol</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
            <span class="n">contents</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">fn</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocols</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.streamdevice.StreamProtocol" class="doc doc-heading">
        <code>
whatrecord.streamdevice.StreamProtocol        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Representation of a StreamDevice protocol.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">StreamProtocol</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Representation of a StreamDevice protocol.&quot;&quot;&quot;</span>
    <span class="n">variables</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">protocols</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ProtocolDefinition</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">comments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">handlers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">HandlerDefinition</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">contents</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load a protocol file given its string contents.&quot;&quot;&quot;</span>
        <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
            <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
            <span class="s2">&quot;streamdevice.lark&quot;</span><span class="p">,</span>
            <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,</span> <span class="p">),</span>
            <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;earley&quot;</span><span class="p">,</span>
            <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="c1"># lexer_callbacks={&quot;COMMENT&quot;: comments.append},</span>
        <span class="p">)</span>

        <span class="n">proto</span> <span class="o">=</span> <span class="n">_ProtocolTransformer</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
            <span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">proto</span><span class="o">.</span><span class="n">comments</span> <span class="o">=</span> <span class="n">comments</span>
        <span class="k">return</span> <span class="n">proto</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load a protocol file given a file object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load a StreamDevice protocol file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : pathlib.Path or str</span>
<span class="sd">            The filename.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        protocol : StreamProtocol</span>
<span class="sd">            The StreamDevice protocol.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">fn</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">












<h6 id="whatrecord.streamdevice.StreamProtocol-methods">Methods</h6>




  <div class="doc doc-object doc-method">



<h7 id="whatrecord.streamdevice.StreamProtocol.from_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">streamdevice</span><span class="o">.</span><span class="n">StreamProtocol</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a StreamDevice protocol file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>pathlib.Path or str</code></td>
        <td><p>The filename.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>StreamProtocol</code></td>
      <td><p>The StreamDevice protocol.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a StreamDevice protocol file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : pathlib.Path or str</span>
<span class="sd">        The filename.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    protocol : StreamProtocol</span>
<span class="sd">        The StreamDevice protocol.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="n">fn</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.streamdevice.StreamProtocol.from_file_obj" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">streamdevice</span><span class="o">.</span><span class="n">StreamProtocol</span><span class="o">.</span><span class="n">from_file_obj</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a protocol file given a file object.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load a protocol file given a file object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
        <span class="n">filename</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="whatrecord.streamdevice.StreamProtocol.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">streamdevice</span><span class="o">.</span><span class="n">StreamProtocol</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Load a protocol file given its string contents.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">contents</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StreamProtocol</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load a protocol file given its string contents.&quot;&quot;&quot;</span>
    <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">grammar</span> <span class="o">=</span> <span class="n">lark</span><span class="o">.</span><span class="n">Lark</span><span class="o">.</span><span class="n">open_from_package</span><span class="p">(</span>
        <span class="s2">&quot;whatrecord&quot;</span><span class="p">,</span>
        <span class="s2">&quot;streamdevice.lark&quot;</span><span class="p">,</span>
        <span class="n">search_paths</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;grammar&quot;</span><span class="p">,</span> <span class="p">),</span>
        <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;earley&quot;</span><span class="p">,</span>
        <span class="n">maybe_placeholders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="c1"># lexer_callbacks={&quot;COMMENT&quot;: comments.append},</span>
    <span class="p">)</span>

    <span class="n">proto</span> <span class="o">=</span> <span class="n">_ProtocolTransformer</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
        <span class="n">grammar</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">proto</span><span class="o">.</span><span class="n">comments</span> <span class="o">=</span> <span class="n">comments</span>
    <span class="k">return</span> <span class="n">proto</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="whatrecord.streamdevice.VariableAssignment" class="doc doc-heading">
        <code>
whatrecord.streamdevice.VariableAssignment        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>VariableAssignment(name: 'str', value: 'str')</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/streamdevice.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">VariableAssignment</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="whatrecord.transformer" class="doc doc-heading">
        <code>whatrecord.transformer</code>



</h3>

    <div class="doc doc-contents first">

      <p>Helpers for writing lark transformers.</p>



  <div class="doc doc-children">







<h4 id="whatrecord.transformer-functions">Functions</h4>

  <div class="doc doc-object doc-function">



<h5 id="whatrecord.transformer.context_from_token" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">transformer</span><span class="o">.</span><span class="n">context_from_token</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="n">Token</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">whatrecord</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">LoadContext</span><span class="p">]</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Get a LoadContext from a lark Token.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/transformer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">context_from_token</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="n">lark</span><span class="o">.</span><span class="n">Token</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FullLoadContext</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get a LoadContext from a lark Token.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">LoadContext</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">token</span><span class="o">.</span><span class="n">line</span><span class="p">),</span> <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="whatrecord.transformer.context_from_tree" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">transformer</span><span class="o">.</span><span class="n">context_from_tree</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">Tree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">whatrecord</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">LoadContext</span><span class="p">]</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Get a LoadContext from a lark Tree.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/transformer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">context_from_tree</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">lark</span><span class="o">.</span><span class="n">Tree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FullLoadContext</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get a LoadContext from a lark Tree.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">LoadContext</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">line</span><span class="p">),</span> <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="whatrecord.transformer.dictify" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">transformer</span><span class="o">.</span><span class="n">dictify</span><span class="p">(</span><span class="o">*</span><span class="n">tuples</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Transformer helper to stringify a single argument.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/transformer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">dictify</span><span class="p">(</span><span class="o">*</span><span class="n">tuples</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Transformer helper to stringify a single argument.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">tuples</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="whatrecord.transformer.ignore" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">transformer</span><span class="o">.</span><span class="n">ignore</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Transformer helper to drop the subtree.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/transformer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">ignore</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Transformer helper to drop the subtree.&quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="whatrecord.transformer.listify" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">transformer</span><span class="o">.</span><span class="n">listify</span><span class="p">(</span><span class="o">*</span><span class="n">objects</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Transformer helper to listify *args.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/transformer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">listify</span><span class="p">(</span><span class="o">*</span><span class="n">objects</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Transformer helper to listify *args.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="whatrecord.transformer.listify_strings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">transformer</span><span class="o">.</span><span class="n">listify_strings</span><span class="p">(</span><span class="o">*</span><span class="n">objects</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">lark</span><span class="o">.</span><span class="n">lexer</span><span class="o">.</span><span class="n">Token</span><span class="p">])</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Transformer helper to listify *args and stringify each arg.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/transformer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">listify_strings</span><span class="p">(</span><span class="o">*</span><span class="n">objects</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">lark</span><span class="o">.</span><span class="n">Token</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Transformer helper to listify *args and stringify each arg.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="whatrecord.transformer.pass_through" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">transformer</span><span class="o">.</span><span class="n">pass_through</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Transformer helper to pass through an optional single argument.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/transformer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">pass_through</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Transformer helper to pass through an optional single argument.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="whatrecord.transformer.stringify" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">transformer</span><span class="o">.</span><span class="n">stringify</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Token</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Transformer helper to stringify a single argument.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/transformer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">lark</span><span class="o">.</span><span class="n">Token</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Transformer helper to stringify a single argument.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="whatrecord.transformer.tuple_args" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whatrecord</span><span class="o">.</span><span class="n">transformer</span><span class="o">.</span><span class="n">tuple_args</span><span class="p">(</span><span class="o">*</span><span class="n">objects</span><span class="p">:</span> <span class="o">~</span><span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Transformer helper to get back the *args tuple.</p>

        <details class="quote">
          <summary>Source code in <code>whatrecord/transformer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">tuple_args</span><span class="p">(</span><span class="o">*</span><span class="n">objects</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Transformer helper to get back the *args tuple.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">objects</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: whatrecord" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              whatrecord
            </div>
          </div>
        </a>
      
      
        
        <a href="../cli/" class="md-footer__link md-footer__link--next" aria-label="Next: CLI" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              CLI
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      (C) 2021 SLAC National Accelerator Laboratory
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.top", "toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.01de222e.min.js"></script>
      
    
  </body>
</html>